<!DOCTYPE html>
<html lang="zh-CN" dir="ltr">
  <head>
    <meta charset="utf-8">
    
    <title>插槽实现原理 | promise96319</title>
    <meta name="description" content="前端开发">
    <link rel="preload stylesheet" href="/assets/style.acbba938.css" as="style">
    
    <script type="module" src="/assets/app.a69116c8.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.2ed14f66.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/framework.b96c6c14.js">
    <link rel="modulepreload" href="/assets/chunks/theme.07d27420.js">
    <link rel="modulepreload" href="/assets/vue_插槽实现原理.md.65963408.lean.js">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no, minimal-ui">
    <meta name="theme-color" content="#5f67ee">
    <meta name="og:type" content="website">
    <meta name="og:locale" content="zh">
    <meta name="og:site_name" content="前端开发">
    <script>var _hmt=_hmt||[];(function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?41a9a03811977ee15c69366a880d1296";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})();</script>
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-5a346dfe><!--[--><!--]--><!--[--><span tabindex="-1" data-v-0f60ec36></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-0f60ec36> Skip to content </a><!--]--><!----><header class="VPNav" data-v-5a346dfe data-v-ae24b3ad><div class="VPNavBar has-sidebar" data-v-ae24b3ad data-v-a0fd61f4><div class="container" data-v-a0fd61f4><div class="title" data-v-a0fd61f4><div class="VPNavBarTitle has-sidebar" data-v-a0fd61f4 data-v-86d1bed8><a class="title" href="/" data-v-86d1bed8><!--[--><!--]--><!--[--><img class="VPImage logo" src="/logo.png" alt data-v-8426fc1a><!--]--><!--[-->promise96319<!--]--><!--[--><!--]--></a></div></div><div class="content" data-v-a0fd61f4><div class="curtain" data-v-a0fd61f4></div><div class="content-body" data-v-a0fd61f4><!--[--><!--]--><div class="VPNavBarSearch search" data-v-a0fd61f4><!--[--><!----><div id="docsearch"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg class="DocSearch-Search-Icon" width="20" height="20" viewBox="0 0 20 20" aria-label="search icon"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-a0fd61f4 data-v-7f418b0f><span id="main-nav-aria-label" class="visually-hidden" data-v-7f418b0f>Main Navigation</span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/articles/index" tabindex="0" data-v-7f418b0f data-v-42ef59de><!--[--><span data-v-42ef59de>文章</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/ai/index" tabindex="0" data-v-7f418b0f data-v-42ef59de><!--[--><span data-v-42ef59de>AI</span><!--]--></a><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-7f418b0f data-v-9c007e85><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-9c007e85><span class="text" data-v-9c007e85><!----><span data-v-9c007e85>框架系列</span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-9c007e85><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-9c007e85><div class="VPMenu" data-v-9c007e85 data-v-e7ea1737><div class="items" data-v-e7ea1737><!--[--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/vue/" data-v-43f1e123><!--[-->Vue v2 源码<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/vue3/" data-v-43f1e123><!--[-->Vue v3 源码<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/react/" data-v-43f1e123><!--[-->React v17 源码<!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-7f418b0f data-v-9c007e85><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-9c007e85><span class="text" data-v-9c007e85><!----><span data-v-9c007e85>基建系列</span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-9c007e85><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-9c007e85><div class="VPMenu" data-v-9c007e85 data-v-e7ea1737><div class="items" data-v-e7ea1737><!--[--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/webpack/" data-v-43f1e123><!--[-->Webpack 系列<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/rollup/" data-v-43f1e123><!--[-->Rollup 系列<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/vite/" data-v-43f1e123><!--[-->Vite 系列<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/babel/" data-v-43f1e123><!--[-->Babel 系列<!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-7f418b0f data-v-9c007e85><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-9c007e85><span class="text" data-v-9c007e85><!----><span data-v-9c007e85>JS 系列</span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-9c007e85><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-9c007e85><div class="VPMenu" data-v-9c007e85 data-v-e7ea1737><div class="items" data-v-e7ea1737><!--[--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/javascript/" data-v-43f1e123><!--[-->ES6<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/node/" data-v-43f1e123><!--[-->Node<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/typescript/" data-v-43f1e123><!--[-->Typescript<!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-7f418b0f data-v-9c007e85><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-9c007e85><span class="text" data-v-9c007e85><!----><span data-v-9c007e85>计算机基础</span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-9c007e85><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-9c007e85><div class="VPMenu" data-v-9c007e85 data-v-e7ea1737><div class="items" data-v-e7ea1737><!--[--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/algorithms/" data-v-43f1e123><!--[-->算法<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/data-structures/" data-v-43f1e123><!--[-->数据结构<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/design-pattern/" data-v-43f1e123><!--[-->设计模式<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/network/" data-v-43f1e123><!--[-->网络<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/leetcode/" data-v-43f1e123><!--[-->LeetCode<!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-7f418b0f data-v-9c007e85><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-9c007e85><span class="text" data-v-9c007e85><!----><span data-v-9c007e85>开发</span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-9c007e85><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-9c007e85><div class="VPMenu" data-v-9c007e85 data-v-e7ea1737><div class="items" data-v-e7ea1737><!--[--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/tools/" data-v-43f1e123><!--[-->工具<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/config/" data-v-43f1e123><!--[-->配置<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/resources/" data-v-43f1e123><!--[-->资料<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/project/" data-v-43f1e123><!--[-->项目<!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-a0fd61f4 data-v-e6aabb21><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="toggle dark mode" aria-checked="false" data-v-e6aabb21 data-v-ce54a7d1 data-v-b1685198><span class="check" data-v-b1685198><span class="icon" data-v-b1685198><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-ce54a7d1><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-ce54a7d1><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-a0fd61f4 data-v-0394ad82 data-v-7bc22406><!--[--><a class="VPSocialLink no-icon" href="https://github.com/promise96319" aria-label="github" target="_blank" rel="noopener" data-v-7bc22406 data-v-f80f8133><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-a0fd61f4 data-v-40855f84 data-v-9c007e85><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-9c007e85><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-9c007e85><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-9c007e85><div class="VPMenu" data-v-9c007e85 data-v-e7ea1737><!----><!--[--><!--[--><!----><div class="group" data-v-40855f84><div class="item appearance" data-v-40855f84><p class="label" data-v-40855f84>Appearance</p><div class="appearance-action" data-v-40855f84><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="toggle dark mode" aria-checked="false" data-v-40855f84 data-v-ce54a7d1 data-v-b1685198><span class="check" data-v-b1685198><span class="icon" data-v-b1685198><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-ce54a7d1><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-ce54a7d1><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div></div></div><div class="group" data-v-40855f84><div class="item social-links" data-v-40855f84><div class="VPSocialLinks social-links-list" data-v-40855f84 data-v-7bc22406><!--[--><a class="VPSocialLink no-icon" href="https://github.com/promise96319" aria-label="github" target="_blank" rel="noopener" data-v-7bc22406 data-v-f80f8133><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-a0fd61f4 data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div></div><!----></header><div class="VPLocalNav reached-top" data-v-5a346dfe data-v-79c8c1df><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-79c8c1df><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="menu-icon" data-v-79c8c1df><path d="M17,11H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,11,17,11z"></path><path d="M21,7H3C2.4,7,2,6.6,2,6s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,7,21,7z"></path><path d="M21,15H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,15,21,15z"></path><path d="M17,19H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,19,17,19z"></path></svg><span class="menu-text" data-v-79c8c1df>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-79c8c1df data-v-1c15a60a><button data-v-1c15a60a>Return to top</button><!----></div></div><aside class="VPSidebar" data-v-5a346dfe data-v-b00e2fdd><div class="curtain" data-v-b00e2fdd></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-b00e2fdd><span class="visually-hidden" id="sidebar-aria-label" data-v-b00e2fdd> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="group" data-v-b00e2fdd><section class="VPSidebarItem level-0 collapsible has-active" data-v-b00e2fdd data-v-e31bd47b><div class="item" role="button" tabindex="0" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><h2 class="text" data-v-e31bd47b>Vue2原理</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-e31bd47b><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="caret-icon" data-v-e31bd47b><path d="M9,19c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l5.3-5.3L8.3,6.7c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l6,6c0.4,0.4,0.4,1,0,1.4l-6,6C9.5,18.9,9.3,19,9,19z"></path></svg></div></div><div class="items" data-v-e31bd47b><!--[--><div class="VPSidebarItem level-1 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/vue/%E7%BB%84%E6%88%90%E4%B8%8E%E8%AE%BE%E8%AE%A1" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>组成与设计</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/vue/%E9%80%89%E9%A1%B9%E5%90%88%E5%B9%B6" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>选项合并</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/vue/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%8E%9F%E7%90%86%E4%B8%8A%E7%AF%87" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>响应式原理上篇</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/vue/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%8E%9F%E7%90%86%E4%B8%AD%E7%AF%87" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>响应式原理中篇</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/vue/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%8E%9F%E7%90%86%E4%B8%8B%E7%AF%87" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>响应式原理下篇</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/vue/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86%E4%B8%8A%E7%AF%87" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>编译原理上篇</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/vue/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86%E4%B8%AD%E7%AF%87" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>编译原理中篇</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/vue/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86%E4%B8%8B%E7%AF%87" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>编译原理下篇</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/vue/%E6%8F%92%E6%A7%BD%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>插槽实现原理</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/vue/%E7%BB%84%E4%BB%B6%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>组件实现原理</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/vue/%E4%B8%80%E4%BA%9B%E5%8E%9F%E7%90%86%E6%B1%87%E6%80%BB" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>一些原理汇总</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/vue/%E6%89%8B%E5%86%99%E7%AE%80%E7%89%88Vuex" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>手写简版Vuex</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/vue/%E6%89%8B%E5%86%99%E7%AE%80%E7%89%88VueRouter" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>手写简版VueRouter</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/vue/%E9%98%85%E8%AF%BB%E8%B5%84%E6%96%99" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>阅读资料</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-5a346dfe data-v-669faec9><div class="VPDoc has-sidebar has-aside" data-v-669faec9 data-v-6b87e69f><!--[--><!--]--><div class="container" data-v-6b87e69f><div class="aside" data-v-6b87e69f><div class="aside-curtain" data-v-6b87e69f></div><div class="aside-container" data-v-6b87e69f><div class="aside-content" data-v-6b87e69f><div class="VPDocAside" data-v-6b87e69f data-v-3f215769><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline" role="navigation" data-v-3f215769 data-v-d330b1bb><div class="content" data-v-d330b1bb><div class="outline-marker" data-v-d330b1bb></div><div class="outline-title" role="heading" aria-level="2" data-v-d330b1bb>On this page</div><nav aria-labelledby="doc-outline-aria-label" data-v-d330b1bb><span class="visually-hidden" id="doc-outline-aria-label" data-v-d330b1bb> Table of Contents for current page </span><ul class="root" data-v-d330b1bb data-v-d0ee3533><!--[--><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-3f215769></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-6b87e69f><div class="content-container" data-v-6b87e69f><!--[--><!--]--><!----><main class="main" data-v-6b87e69f><div style="position:relative;" class="vp-doc _vue_%E6%8F%92%E6%A7%BD%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86" data-v-6b87e69f><div><h1 id="插槽实现原理" tabindex="-1">插槽实现原理 <a class="header-anchor" href="#插槽实现原理" aria-label="Permalink to &quot;插槽实现原理&quot;">​</a></h1><p>首先是父组件：</p><h2 id="父组件使用" tabindex="-1">父组件使用 <a class="header-anchor" href="#父组件使用" aria-label="Permalink to &quot;父组件使用&quot;">​</a></h2><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">// 1. 父组件使用时</span></span>
<span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#79B8FF;">ChildComponent</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">class</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;component&quot;</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">  &lt;</span><span style="color:#85E89D;">template</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">v-slot</span><span style="color:#E1E4E8;">:</span><span style="color:#B392F0;">default</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;scope&quot;</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">    {{ scope }}</span></span>
<span class="line"><span style="color:#E1E4E8;">  &lt;/</span><span style="color:#85E89D;">template</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">&lt;/</span><span style="color:#79B8FF;">ChildComponent</span><span style="color:#E1E4E8;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">// 1. 父组件使用时</span></span>
<span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#005CC5;">ChildComponent</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">class</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;component&quot;</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">  &lt;</span><span style="color:#22863A;">template</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">v-slot</span><span style="color:#24292E;">:</span><span style="color:#6F42C1;">default</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;scope&quot;</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    {{ scope }}</span></span>
<span class="line"><span style="color:#24292E;">  &lt;/</span><span style="color:#22863A;">template</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">&lt;/</span><span style="color:#005CC5;">ChildComponent</span><span style="color:#24292E;">&gt;</span></span></code></pre></div><h2 id="父组件parse" tabindex="-1">父组件parse <a class="header-anchor" href="#父组件parse" aria-label="Permalink to &quot;父组件parse&quot;">​</a></h2><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">// 2. 经过 parse 编译成 ast 后 (调用的是 processSlotContent 方法)</span></span>
<span class="line"><span style="color:#6A737D;">// 绑定的值（由子组件传递）</span></span>
<span class="line"><span style="color:#E1E4E8;">el.slotScope </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> scope</span></span>
<span class="line"><span style="color:#6A737D;">// 绑定的 slot 名称</span></span>
<span class="line"><span style="color:#E1E4E8;">el.slotTarget </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;default&quot;</span></span>
<span class="line"><span style="color:#6A737D;">// 动态绑定的 slot 名称</span></span>
<span class="line"><span style="color:#E1E4E8;">el.slotTargetDynamic </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">default</span></span>
<span class="line"><span style="color:#6A737D;">// template 内部 children 代码</span></span>
<span class="line"><span style="color:#E1E4E8;">el.children </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> []</span></span>
<span class="line"><span style="color:#6A737D;">// ChildComponent 对应的 ast 下的 scopedSlots 记录着 slot 的 ast</span></span>
<span class="line"><span style="color:#E1E4E8;">currentParent.scopedSlots </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> {}))[name] </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> element</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">// 2. 经过 parse 编译成 ast 后 (调用的是 processSlotContent 方法)</span></span>
<span class="line"><span style="color:#6A737D;">// 绑定的值（由子组件传递）</span></span>
<span class="line"><span style="color:#24292E;">el.slotScope </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> scope</span></span>
<span class="line"><span style="color:#6A737D;">// 绑定的 slot 名称</span></span>
<span class="line"><span style="color:#24292E;">el.slotTarget </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;default&quot;</span></span>
<span class="line"><span style="color:#6A737D;">// 动态绑定的 slot 名称</span></span>
<span class="line"><span style="color:#24292E;">el.slotTargetDynamic </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">default</span></span>
<span class="line"><span style="color:#6A737D;">// template 内部 children 代码</span></span>
<span class="line"><span style="color:#24292E;">el.children </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> []</span></span>
<span class="line"><span style="color:#6A737D;">// ChildComponent 对应的 ast 下的 scopedSlots 记录着 slot 的 ast</span></span>
<span class="line"><span style="color:#24292E;">currentParent.scopedSlots </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> {}))[name] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> element</span></span></code></pre></div><h2 id="父组件generate" tabindex="-1">父组件generate <a class="header-anchor" href="#父组件generate" aria-label="Permalink to &quot;父组件generate&quot;">​</a></h2><h3 id="gendata" tabindex="-1">genData <a class="header-anchor" href="#gendata" aria-label="Permalink to &quot;genData&quot;">​</a></h3><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">// 3. 经过 generate 生成代码后（先调用 genData 方法，此时会调用 genScopedSlots 方法）</span></span>
<span class="line"><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (el.slotTarget </span><span style="color:#F97583;">&amp;&amp;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">!</span><span style="color:#E1E4E8;">el.slotScope) {</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// 如果不存在 slotScope，表示没有传递参数</span></span>
<span class="line"><span style="color:#E1E4E8;">  data </span><span style="color:#F97583;">+=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">`slot:${</span><span style="color:#E1E4E8;">el</span><span style="color:#9ECBFF;">.</span><span style="color:#E1E4E8;">slotTarget</span><span style="color:#9ECBFF;">},`</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"><span style="color:#6A737D;">// 对于 ChildComponent 这个组件</span></span>
<span class="line"><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (el.scopedSlots) {</span></span>
<span class="line"><span style="color:#E1E4E8;">  data </span><span style="color:#F97583;">+=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">`${</span><span style="color:#B392F0;">genScopedSlots</span><span style="color:#9ECBFF;">(</span><span style="color:#E1E4E8;">el</span><span style="color:#9ECBFF;">, </span><span style="color:#E1E4E8;">el</span><span style="color:#9ECBFF;">.</span><span style="color:#E1E4E8;">scopedSlots</span><span style="color:#9ECBFF;">, </span><span style="color:#E1E4E8;">state</span><span style="color:#9ECBFF;">)</span><span style="color:#9ECBFF;">},`</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">// 3. 经过 generate 生成代码后（先调用 genData 方法，此时会调用 genScopedSlots 方法）</span></span>
<span class="line"><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (el.slotTarget </span><span style="color:#D73A49;">&amp;&amp;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">!</span><span style="color:#24292E;">el.slotScope) {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// 如果不存在 slotScope，表示没有传递参数</span></span>
<span class="line"><span style="color:#24292E;">  data </span><span style="color:#D73A49;">+=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">`slot:${</span><span style="color:#24292E;">el</span><span style="color:#032F62;">.</span><span style="color:#24292E;">slotTarget</span><span style="color:#032F62;">},`</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"><span style="color:#6A737D;">// 对于 ChildComponent 这个组件</span></span>
<span class="line"><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (el.scopedSlots) {</span></span>
<span class="line"><span style="color:#24292E;">  data </span><span style="color:#D73A49;">+=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">`${</span><span style="color:#6F42C1;">genScopedSlots</span><span style="color:#032F62;">(</span><span style="color:#24292E;">el</span><span style="color:#032F62;">, </span><span style="color:#24292E;">el</span><span style="color:#032F62;">.</span><span style="color:#24292E;">scopedSlots</span><span style="color:#032F62;">, </span><span style="color:#24292E;">state</span><span style="color:#032F62;">)</span><span style="color:#032F62;">},`</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h3 id="genscopedslots" tabindex="-1">genScopedSlots <a class="header-anchor" href="#genscopedslots" aria-label="Permalink to &quot;genScopedSlots&quot;">​</a></h3><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">// 4. genScopedSlots 方法</span></span>
<span class="line"><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">genScopedSlots</span><span style="color:#E1E4E8;">(</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#FFAB70;">el</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">ASTElement</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#FFAB70;">slots</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> { [</span><span style="color:#FFAB70;">key</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">string</span><span style="color:#E1E4E8;">]</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">ASTElement</span><span style="color:#E1E4E8;"> },</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#FFAB70;">state</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">CodegenState</span></span>
<span class="line"><span style="color:#E1E4E8;">)</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">string</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// 通过这里判断 slot 是否需要强制更新。</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">let</span><span style="color:#E1E4E8;"> needsForceUpdate </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> el.for </span><span style="color:#F97583;">||</span><span style="color:#E1E4E8;"> Object.</span><span style="color:#B392F0;">keys</span><span style="color:#E1E4E8;">(slots).</span><span style="color:#B392F0;">some</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">key</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">slot</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> slots[key]</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> (</span></span>
<span class="line"><span style="color:#E1E4E8;">      slot.slotTargetDynamic </span><span style="color:#F97583;">||</span><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// 如果存在动态绑定的类型</span></span>
<span class="line"><span style="color:#E1E4E8;">      slot.if </span><span style="color:#F97583;">||</span><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;">// 如果在 if 中</span></span>
<span class="line"><span style="color:#E1E4E8;">      slot.for </span><span style="color:#F97583;">||</span><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;">// 如果在 for 中</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#B392F0;">containsSlotChild</span><span style="color:#E1E4E8;">(slot) </span><span style="color:#6A737D;">// 如果内部还存在 slot 标签</span></span>
<span class="line"><span style="color:#E1E4E8;">    )</span></span>
<span class="line"><span style="color:#E1E4E8;">  })</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">let</span><span style="color:#E1E4E8;"> needsKey </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">!!</span><span style="color:#E1E4E8;">el.if</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// 继续判断是否需要更新</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// 不需要强制更新时，判断是否在 for 循环或 if 当中</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// 判断 parent.slotScope 存在</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (</span><span style="color:#F97583;">!</span><span style="color:#E1E4E8;">needsForceUpdate) {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">let</span><span style="color:#E1E4E8;"> parent </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> el.parent</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">while</span><span style="color:#E1E4E8;"> (parent) {</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (</span></span>
<span class="line"><span style="color:#E1E4E8;">        (parent.slotScope </span><span style="color:#F97583;">&amp;&amp;</span><span style="color:#E1E4E8;"> parent.slotScope </span><span style="color:#F97583;">!==</span><span style="color:#E1E4E8;"> emptySlotScopeToken) </span><span style="color:#F97583;">||</span></span>
<span class="line"><span style="color:#E1E4E8;">        parent.for</span></span>
<span class="line"><span style="color:#E1E4E8;">      ) {</span></span>
<span class="line"><span style="color:#E1E4E8;">        needsForceUpdate </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">true</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">break</span></span>
<span class="line"><span style="color:#E1E4E8;">      }</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (parent.if) {</span></span>
<span class="line"><span style="color:#E1E4E8;">        needsKey </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">true</span></span>
<span class="line"><span style="color:#E1E4E8;">      }</span></span>
<span class="line"><span style="color:#E1E4E8;">      parent </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> parent.parent</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// 键值对形式： [{ key: &quot;default&quot;: fn: fn, proxy: false/true }]</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">generatedSlots</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> Object.</span><span style="color:#B392F0;">keys</span><span style="color:#E1E4E8;">(slots)</span></span>
<span class="line"><span style="color:#E1E4E8;">    .</span><span style="color:#B392F0;">map</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">key</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">genScopedSlot</span><span style="color:#E1E4E8;">(slots[key], state))</span></span>
<span class="line"><span style="color:#E1E4E8;">    .</span><span style="color:#B392F0;">join</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;,&#39;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">`scopedSlots:_u([${</span><span style="color:#E1E4E8;">generatedSlots</span><span style="color:#9ECBFF;">}]${</span><span style="color:#E1E4E8;">needsForceUpdate</span><span style="color:#9ECBFF;"> </span><span style="color:#F97583;">?</span><span style="color:#9ECBFF;"> </span><span style="color:#9ECBFF;">`,null,true`</span><span style="color:#9ECBFF;"> </span><span style="color:#F97583;">:</span><span style="color:#9ECBFF;"> </span><span style="color:#9ECBFF;">``</span></span>
<span class="line"><span style="color:#9ECBFF;">    </span><span style="color:#9ECBFF;">}${</span><span style="color:#F97583;">!</span><span style="color:#E1E4E8;">needsForceUpdate</span><span style="color:#9ECBFF;"> </span><span style="color:#F97583;">&amp;&amp;</span><span style="color:#9ECBFF;"> </span><span style="color:#E1E4E8;">needsKey</span><span style="color:#9ECBFF;"> </span><span style="color:#F97583;">?</span><span style="color:#9ECBFF;"> </span><span style="color:#9ECBFF;">`,null,false,${</span><span style="color:#B392F0;">hash</span><span style="color:#9ECBFF;">(</span><span style="color:#E1E4E8;">generatedSlots</span><span style="color:#9ECBFF;">)</span><span style="color:#9ECBFF;">}`</span><span style="color:#9ECBFF;"> </span><span style="color:#F97583;">:</span><span style="color:#9ECBFF;"> </span><span style="color:#9ECBFF;">``</span></span>
<span class="line"><span style="color:#9ECBFF;">    </span><span style="color:#9ECBFF;">})`</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">// 4. genScopedSlots 方法</span></span>
<span class="line"><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">genScopedSlots</span><span style="color:#24292E;">(</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#E36209;">el</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ASTElement</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#E36209;">slots</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> { [</span><span style="color:#E36209;">key</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">string</span><span style="color:#24292E;">]</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ASTElement</span><span style="color:#24292E;"> },</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#E36209;">state</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">CodegenState</span></span>
<span class="line"><span style="color:#24292E;">)</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">string</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// 通过这里判断 slot 是否需要强制更新。</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">let</span><span style="color:#24292E;"> needsForceUpdate </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> el.for </span><span style="color:#D73A49;">||</span><span style="color:#24292E;"> Object.</span><span style="color:#6F42C1;">keys</span><span style="color:#24292E;">(slots).</span><span style="color:#6F42C1;">some</span><span style="color:#24292E;">(</span><span style="color:#E36209;">key</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">slot</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> slots[key]</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> (</span></span>
<span class="line"><span style="color:#24292E;">      slot.slotTargetDynamic </span><span style="color:#D73A49;">||</span><span style="color:#24292E;">  </span><span style="color:#6A737D;">// 如果存在动态绑定的类型</span></span>
<span class="line"><span style="color:#24292E;">      slot.if </span><span style="color:#D73A49;">||</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">// 如果在 if 中</span></span>
<span class="line"><span style="color:#24292E;">      slot.for </span><span style="color:#D73A49;">||</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">// 如果在 for 中</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#6F42C1;">containsSlotChild</span><span style="color:#24292E;">(slot) </span><span style="color:#6A737D;">// 如果内部还存在 slot 标签</span></span>
<span class="line"><span style="color:#24292E;">    )</span></span>
<span class="line"><span style="color:#24292E;">  })</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">let</span><span style="color:#24292E;"> needsKey </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">!!</span><span style="color:#24292E;">el.if</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// 继续判断是否需要更新</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// 不需要强制更新时，判断是否在 for 循环或 if 当中</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// 判断 parent.slotScope 存在</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">!</span><span style="color:#24292E;">needsForceUpdate) {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">let</span><span style="color:#24292E;"> parent </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> el.parent</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">while</span><span style="color:#24292E;"> (parent) {</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (</span></span>
<span class="line"><span style="color:#24292E;">        (parent.slotScope </span><span style="color:#D73A49;">&amp;&amp;</span><span style="color:#24292E;"> parent.slotScope </span><span style="color:#D73A49;">!==</span><span style="color:#24292E;"> emptySlotScopeToken) </span><span style="color:#D73A49;">||</span></span>
<span class="line"><span style="color:#24292E;">        parent.for</span></span>
<span class="line"><span style="color:#24292E;">      ) {</span></span>
<span class="line"><span style="color:#24292E;">        needsForceUpdate </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">true</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">break</span></span>
<span class="line"><span style="color:#24292E;">      }</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (parent.if) {</span></span>
<span class="line"><span style="color:#24292E;">        needsKey </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">true</span></span>
<span class="line"><span style="color:#24292E;">      }</span></span>
<span class="line"><span style="color:#24292E;">      parent </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> parent.parent</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// 键值对形式： [{ key: &quot;default&quot;: fn: fn, proxy: false/true }]</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">generatedSlots</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Object.</span><span style="color:#6F42C1;">keys</span><span style="color:#24292E;">(slots)</span></span>
<span class="line"><span style="color:#24292E;">    .</span><span style="color:#6F42C1;">map</span><span style="color:#24292E;">(</span><span style="color:#E36209;">key</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">genScopedSlot</span><span style="color:#24292E;">(slots[key], state))</span></span>
<span class="line"><span style="color:#24292E;">    .</span><span style="color:#6F42C1;">join</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;,&#39;</span><span style="color:#24292E;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#032F62;">`scopedSlots:_u([${</span><span style="color:#24292E;">generatedSlots</span><span style="color:#032F62;">}]${</span><span style="color:#24292E;">needsForceUpdate</span><span style="color:#032F62;"> </span><span style="color:#D73A49;">?</span><span style="color:#032F62;"> </span><span style="color:#032F62;">`,null,true`</span><span style="color:#032F62;"> </span><span style="color:#D73A49;">:</span><span style="color:#032F62;"> </span><span style="color:#032F62;">``</span></span>
<span class="line"><span style="color:#032F62;">    </span><span style="color:#032F62;">}${</span><span style="color:#D73A49;">!</span><span style="color:#24292E;">needsForceUpdate</span><span style="color:#032F62;"> </span><span style="color:#D73A49;">&amp;&amp;</span><span style="color:#032F62;"> </span><span style="color:#24292E;">needsKey</span><span style="color:#032F62;"> </span><span style="color:#D73A49;">?</span><span style="color:#032F62;"> </span><span style="color:#032F62;">`,null,false,${</span><span style="color:#6F42C1;">hash</span><span style="color:#032F62;">(</span><span style="color:#24292E;">generatedSlots</span><span style="color:#032F62;">)</span><span style="color:#032F62;">}`</span><span style="color:#032F62;"> </span><span style="color:#D73A49;">:</span><span style="color:#032F62;"> </span><span style="color:#032F62;">``</span></span>
<span class="line"><span style="color:#032F62;">    </span><span style="color:#032F62;">})`</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h3 id="genscopedslot" tabindex="-1">genScopedSlot <a class="header-anchor" href="#genscopedslot" aria-label="Permalink to &quot;genScopedSlot&quot;">​</a></h3><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">genScopedSlot</span><span style="color:#E1E4E8;">(</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#FFAB70;">el</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">ASTElement</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#FFAB70;">state</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">CodegenState</span></span>
<span class="line"><span style="color:#E1E4E8;">)</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">string</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// 1. 使用到的变量，将其作为参数</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">slotScope</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> el.slotScope </span><span style="color:#F97583;">===</span><span style="color:#E1E4E8;"> emptySlotScopeToken</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">?</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">``</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">String</span><span style="color:#E1E4E8;">(el.slotScope)</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// 2. 定义可以生成 vnode 的函数，并传入定义的参数</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">fn</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">`function(${</span><span style="color:#E1E4E8;">slotScope</span><span style="color:#9ECBFF;">}){`</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">`return ${</span><span style="color:#E1E4E8;">el</span><span style="color:#9ECBFF;">.</span><span style="color:#E1E4E8;">tag</span><span style="color:#9ECBFF;"> </span><span style="color:#F97583;">===</span><span style="color:#9ECBFF;"> </span><span style="color:#9ECBFF;">&#39;template&#39;</span></span>
<span class="line"><span style="color:#9ECBFF;">      </span><span style="color:#F97583;">?</span><span style="color:#9ECBFF;"> </span><span style="color:#E1E4E8;">el</span><span style="color:#9ECBFF;">.</span><span style="color:#E1E4E8;">if</span><span style="color:#9ECBFF;"> </span><span style="color:#F97583;">&amp;&amp;</span><span style="color:#9ECBFF;"> </span><span style="color:#E1E4E8;">isLegacySyntax</span></span>
<span class="line"><span style="color:#9ECBFF;">        </span><span style="color:#F97583;">?</span><span style="color:#9ECBFF;"> </span><span style="color:#9ECBFF;">`(${</span><span style="color:#E1E4E8;">el</span><span style="color:#9ECBFF;">.</span><span style="color:#E1E4E8;">if</span><span style="color:#9ECBFF;">})?${</span><span style="color:#B392F0;">genChildren</span><span style="color:#9ECBFF;">(</span><span style="color:#E1E4E8;">el</span><span style="color:#9ECBFF;">, </span><span style="color:#E1E4E8;">state</span><span style="color:#9ECBFF;">) </span><span style="color:#F97583;">||</span><span style="color:#9ECBFF;"> </span><span style="color:#9ECBFF;">&#39;undefined&#39;}:undefined`</span></span>
<span class="line"><span style="color:#9ECBFF;">        </span><span style="color:#F97583;">:</span><span style="color:#9ECBFF;"> </span><span style="color:#B392F0;">genChildren</span><span style="color:#9ECBFF;">(</span><span style="color:#E1E4E8;">el</span><span style="color:#9ECBFF;">, </span><span style="color:#E1E4E8;">state</span><span style="color:#9ECBFF;">) </span><span style="color:#F97583;">||</span><span style="color:#9ECBFF;"> </span><span style="color:#9ECBFF;">&#39;undefined&#39;</span></span>
<span class="line"><span style="color:#9ECBFF;">      </span><span style="color:#F97583;">:</span><span style="color:#9ECBFF;"> </span><span style="color:#B392F0;">genElement</span><span style="color:#9ECBFF;">(</span><span style="color:#E1E4E8;">el</span><span style="color:#9ECBFF;">, </span><span style="color:#E1E4E8;">state</span><span style="color:#9ECBFF;">)</span></span>
<span class="line"><span style="color:#9ECBFF;">    </span><span style="color:#9ECBFF;">}}`</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">reverseProxy</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> slotScope </span><span style="color:#F97583;">?</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">``</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">`,proxy:true`</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// 3. 生成键值对形式</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">`{key:${</span><span style="color:#E1E4E8;">el</span><span style="color:#9ECBFF;">.</span><span style="color:#E1E4E8;">slotTarget</span><span style="color:#9ECBFF;"> </span><span style="color:#F97583;">||</span><span style="color:#9ECBFF;"> </span><span style="color:#9ECBFF;">`&quot;default&quot;`},fn:${</span><span style="color:#E1E4E8;">fn</span><span style="color:#9ECBFF;">}${</span><span style="color:#E1E4E8;">reverseProxy</span><span style="color:#9ECBFF;">}}`</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">genScopedSlot</span><span style="color:#24292E;">(</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#E36209;">el</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ASTElement</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#E36209;">state</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">CodegenState</span></span>
<span class="line"><span style="color:#24292E;">)</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">string</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// 1. 使用到的变量，将其作为参数</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">slotScope</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> el.slotScope </span><span style="color:#D73A49;">===</span><span style="color:#24292E;"> emptySlotScopeToken</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">?</span><span style="color:#24292E;"> </span><span style="color:#032F62;">``</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">String</span><span style="color:#24292E;">(el.slotScope)</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// 2. 定义可以生成 vnode 的函数，并传入定义的参数</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">fn</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">`function(${</span><span style="color:#24292E;">slotScope</span><span style="color:#032F62;">}){`</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#032F62;">`return ${</span><span style="color:#24292E;">el</span><span style="color:#032F62;">.</span><span style="color:#24292E;">tag</span><span style="color:#032F62;"> </span><span style="color:#D73A49;">===</span><span style="color:#032F62;"> </span><span style="color:#032F62;">&#39;template&#39;</span></span>
<span class="line"><span style="color:#032F62;">      </span><span style="color:#D73A49;">?</span><span style="color:#032F62;"> </span><span style="color:#24292E;">el</span><span style="color:#032F62;">.</span><span style="color:#24292E;">if</span><span style="color:#032F62;"> </span><span style="color:#D73A49;">&amp;&amp;</span><span style="color:#032F62;"> </span><span style="color:#24292E;">isLegacySyntax</span></span>
<span class="line"><span style="color:#032F62;">        </span><span style="color:#D73A49;">?</span><span style="color:#032F62;"> </span><span style="color:#032F62;">`(${</span><span style="color:#24292E;">el</span><span style="color:#032F62;">.</span><span style="color:#24292E;">if</span><span style="color:#032F62;">})?${</span><span style="color:#6F42C1;">genChildren</span><span style="color:#032F62;">(</span><span style="color:#24292E;">el</span><span style="color:#032F62;">, </span><span style="color:#24292E;">state</span><span style="color:#032F62;">) </span><span style="color:#D73A49;">||</span><span style="color:#032F62;"> </span><span style="color:#032F62;">&#39;undefined&#39;}:undefined`</span></span>
<span class="line"><span style="color:#032F62;">        </span><span style="color:#D73A49;">:</span><span style="color:#032F62;"> </span><span style="color:#6F42C1;">genChildren</span><span style="color:#032F62;">(</span><span style="color:#24292E;">el</span><span style="color:#032F62;">, </span><span style="color:#24292E;">state</span><span style="color:#032F62;">) </span><span style="color:#D73A49;">||</span><span style="color:#032F62;"> </span><span style="color:#032F62;">&#39;undefined&#39;</span></span>
<span class="line"><span style="color:#032F62;">      </span><span style="color:#D73A49;">:</span><span style="color:#032F62;"> </span><span style="color:#6F42C1;">genElement</span><span style="color:#032F62;">(</span><span style="color:#24292E;">el</span><span style="color:#032F62;">, </span><span style="color:#24292E;">state</span><span style="color:#032F62;">)</span></span>
<span class="line"><span style="color:#032F62;">    </span><span style="color:#032F62;">}}`</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">reverseProxy</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> slotScope </span><span style="color:#D73A49;">?</span><span style="color:#24292E;"> </span><span style="color:#032F62;">``</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">`,proxy:true`</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// 3. 生成键值对形式</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#032F62;">`{key:${</span><span style="color:#24292E;">el</span><span style="color:#032F62;">.</span><span style="color:#24292E;">slotTarget</span><span style="color:#032F62;"> </span><span style="color:#D73A49;">||</span><span style="color:#032F62;"> </span><span style="color:#032F62;">`&quot;default&quot;`},fn:${</span><span style="color:#24292E;">fn</span><span style="color:#032F62;">}${</span><span style="color:#24292E;">reverseProxy</span><span style="color:#032F62;">}}`</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h2 id="父组件render" tabindex="-1">父组件render <a class="header-anchor" href="#父组件render" aria-label="Permalink to &quot;父组件render&quot;">​</a></h2><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">export</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">resolveScopedSlots</span><span style="color:#E1E4E8;">(</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">/**</span></span>
<span class="line"><span style="color:#6A737D;">   * 例如</span></span>
<span class="line"><span style="color:#6A737D;">   * [</span></span>
<span class="line"><span style="color:#6A737D;">   *  {</span></span>
<span class="line"><span style="color:#6A737D;">   *    key: default</span></span>
<span class="line"><span style="color:#6A737D;">   *    fn: (user) =&gt; {...}</span></span>
<span class="line"><span style="color:#6A737D;">   *  }</span></span>
<span class="line"><span style="color:#6A737D;">   * ]</span></span>
<span class="line"><span style="color:#6A737D;">   */</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#FFAB70;">fns</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">ScopedSlotsData</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#FFAB70;">res</span><span style="color:#F97583;">?:</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Object</span><span style="color:#E1E4E8;">,  </span><span style="color:#6A737D;">// null 或者 undefined 或 {xx}</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#FFAB70;">hasDynamicKeys</span><span style="color:#F97583;">?:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">boolean</span><span style="color:#E1E4E8;">, </span><span style="color:#6A737D;">// 是否强制更新</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#FFAB70;">contentHashKey</span><span style="color:#F97583;">?:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">number</span><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;">// 不强制更新时的 hash</span></span>
<span class="line"><span style="color:#E1E4E8;">)</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> { [</span><span style="color:#FFAB70;">key</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">string</span><span style="color:#E1E4E8;">]</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Function</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">$stable</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">boolean</span><span style="color:#E1E4E8;"> } {</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// ! $stable 根据 hasDynamicKeys 判断，在 generate 的时候已经生成</span></span>
<span class="line"><span style="color:#E1E4E8;">  res </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> res </span><span style="color:#F97583;">||</span><span style="color:#E1E4E8;"> { $stable: </span><span style="color:#F97583;">!</span><span style="color:#E1E4E8;">hasDynamicKeys }</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">for</span><span style="color:#E1E4E8;"> (</span><span style="color:#F97583;">let</span><span style="color:#E1E4E8;"> i </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">;i </span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;"> fns.</span><span style="color:#79B8FF;">length</span><span style="color:#E1E4E8;">;i</span><span style="color:#F97583;">++</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">slot</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> fns[i]</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (Array.</span><span style="color:#B392F0;">isArray</span><span style="color:#E1E4E8;">(slot)) {</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#B392F0;">resolveScopedSlots</span><span style="color:#E1E4E8;">(slot, res, hasDynamicKeys)</span></span>
<span class="line"><span style="color:#E1E4E8;">    } </span><span style="color:#F97583;">else</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (slot) {</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (slot.proxy) {</span></span>
<span class="line"><span style="color:#E1E4E8;">        slot.fn.proxy </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">true</span></span>
<span class="line"><span style="color:#E1E4E8;">      }</span></span>
<span class="line"><span style="color:#E1E4E8;">      res[slot.key] </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> slot.fn</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// 转换成了 res { default: fn1, header: fn2  }</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (contentHashKey) {</span></span>
<span class="line"><span style="color:#E1E4E8;">    (</span><span style="color:#FFAB70;">res</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">any</span><span style="color:#E1E4E8;">).$key = contentHashKey</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#E1E4E8;">  return res</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">export</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">resolveScopedSlots</span><span style="color:#24292E;">(</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">/**</span></span>
<span class="line"><span style="color:#6A737D;">   * 例如</span></span>
<span class="line"><span style="color:#6A737D;">   * [</span></span>
<span class="line"><span style="color:#6A737D;">   *  {</span></span>
<span class="line"><span style="color:#6A737D;">   *    key: default</span></span>
<span class="line"><span style="color:#6A737D;">   *    fn: (user) =&gt; {...}</span></span>
<span class="line"><span style="color:#6A737D;">   *  }</span></span>
<span class="line"><span style="color:#6A737D;">   * ]</span></span>
<span class="line"><span style="color:#6A737D;">   */</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#E36209;">fns</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ScopedSlotsData</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#E36209;">res</span><span style="color:#D73A49;">?:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Object</span><span style="color:#24292E;">,  </span><span style="color:#6A737D;">// null 或者 undefined 或 {xx}</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#E36209;">hasDynamicKeys</span><span style="color:#D73A49;">?:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">boolean</span><span style="color:#24292E;">, </span><span style="color:#6A737D;">// 是否强制更新</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#E36209;">contentHashKey</span><span style="color:#D73A49;">?:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">number</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">// 不强制更新时的 hash</span></span>
<span class="line"><span style="color:#24292E;">)</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> { [</span><span style="color:#E36209;">key</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">string</span><span style="color:#24292E;">]</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Function</span><span style="color:#24292E;">, </span><span style="color:#E36209;">$stable</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">boolean</span><span style="color:#24292E;"> } {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// ! $stable 根据 hasDynamicKeys 判断，在 generate 的时候已经生成</span></span>
<span class="line"><span style="color:#24292E;">  res </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> res </span><span style="color:#D73A49;">||</span><span style="color:#24292E;"> { $stable: </span><span style="color:#D73A49;">!</span><span style="color:#24292E;">hasDynamicKeys }</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">for</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">let</span><span style="color:#24292E;"> i </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">;i </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;"> fns.</span><span style="color:#005CC5;">length</span><span style="color:#24292E;">;i</span><span style="color:#D73A49;">++</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">slot</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> fns[i]</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (Array.</span><span style="color:#6F42C1;">isArray</span><span style="color:#24292E;">(slot)) {</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#6F42C1;">resolveScopedSlots</span><span style="color:#24292E;">(slot, res, hasDynamicKeys)</span></span>
<span class="line"><span style="color:#24292E;">    } </span><span style="color:#D73A49;">else</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (slot) {</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (slot.proxy) {</span></span>
<span class="line"><span style="color:#24292E;">        slot.fn.proxy </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">true</span></span>
<span class="line"><span style="color:#24292E;">      }</span></span>
<span class="line"><span style="color:#24292E;">      res[slot.key] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> slot.fn</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// 转换成了 res { default: fn1, header: fn2  }</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (contentHashKey) {</span></span>
<span class="line"><span style="color:#24292E;">    (</span><span style="color:#E36209;">res</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">any</span><span style="color:#24292E;">).$key = contentHashKey</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"><span style="color:#24292E;">  return res</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h2 id="子组件开始实例化" tabindex="-1">子组件开始实例化 <a class="header-anchor" href="#子组件开始实例化" aria-label="Permalink to &quot;子组件开始实例化&quot;">​</a></h2><p>父组件编译完毕后，更新时，会遇到<code>ChildComponent</code>组件，进入到子组件的创建环节，此时<code>data</code>里面包含处理后的<code>scopedSlots</code>。</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">export</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">createComponentInstanceForVnode</span><span style="color:#E1E4E8;"> (</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#FFAB70;">vnode</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">any</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#FFAB70;">parent</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">any</span></span>
<span class="line"><span style="color:#E1E4E8;">)</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Component</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">options</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">InternalComponentOptions</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    _isComponent: </span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    _parentVnode: vnode, </span><span style="color:#6A737D;">// vnode.data 中存放着 scopedSlots</span></span>
<span class="line"><span style="color:#E1E4E8;">    parent </span><span style="color:#6A737D;">// 指向当前更新的组件的实例</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// render 阶段 createComponent 生成vnode的时候，</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// options 都存在componentOptions中</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> vnode.componentOptions.</span><span style="color:#B392F0;">Ctor</span><span style="color:#E1E4E8;">(options)</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">export</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">createComponentInstanceForVnode</span><span style="color:#24292E;"> (</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#E36209;">vnode</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">any</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#E36209;">parent</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">any</span></span>
<span class="line"><span style="color:#24292E;">)</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Component</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">options</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">InternalComponentOptions</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    _isComponent: </span><span style="color:#005CC5;">true</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    _parentVnode: vnode, </span><span style="color:#6A737D;">// vnode.data 中存放着 scopedSlots</span></span>
<span class="line"><span style="color:#24292E;">    parent </span><span style="color:#6A737D;">// 指向当前更新的组件的实例</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// render 阶段 createComponent 生成vnode的时候，</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// options 都存在componentOptions中</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> vnode.componentOptions.</span><span style="color:#6F42C1;">Ctor</span><span style="color:#24292E;">(options)</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h2 id="子组件合并选项" tabindex="-1">子组件合并选项 <a class="header-anchor" href="#子组件合并选项" aria-label="Permalink to &quot;子组件合并选项&quot;">​</a></h2><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">export</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">initInternalComponent</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">vm</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Component</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">options</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">InternalComponentOptions</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// * Vue 构造函数的 options</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// * const options: InternalComponentOptions = {</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// *   _isComponent: true,</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// *   _parentVnode: vnode,</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// *   parent</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// * }</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">opts</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> vm.$options </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> Object.</span><span style="color:#B392F0;">create</span><span style="color:#E1E4E8;">(vm.</span><span style="color:#79B8FF;">constructor</span><span style="color:#E1E4E8;">.options)</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// _parentVnode 为组件的 vnode</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">parentVnode</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> options._parentVnode</span></span>
<span class="line"><span style="color:#E1E4E8;">  opts.parent </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> options.parent</span></span>
<span class="line"><span style="color:#E1E4E8;">  opts._parentVnode </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> parentVnode</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">vnodeComponentOptions</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> parentVnode.componentOptions</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// 组件传值</span></span>
<span class="line"><span style="color:#E1E4E8;">  opts.propsData </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> vnodeComponentOptions.propsData</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// 组件监听的事件</span></span>
<span class="line"><span style="color:#E1E4E8;">  opts._parentListeners </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> vnodeComponentOptions.listeners</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// 组件内部的内容解析为 children。</span></span>
<span class="line"><span style="color:#E1E4E8;">  opts._renderChildren </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> vnodeComponentOptions.children</span></span>
<span class="line"><span style="color:#E1E4E8;">  opts._componentTag </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> vnodeComponentOptions.tag</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">export</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">initInternalComponent</span><span style="color:#24292E;">(</span><span style="color:#E36209;">vm</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Component</span><span style="color:#24292E;">, </span><span style="color:#E36209;">options</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">InternalComponentOptions</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// * Vue 构造函数的 options</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// * const options: InternalComponentOptions = {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// *   _isComponent: true,</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// *   _parentVnode: vnode,</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// *   parent</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// * }</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">opts</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> vm.$options </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Object.</span><span style="color:#6F42C1;">create</span><span style="color:#24292E;">(vm.</span><span style="color:#005CC5;">constructor</span><span style="color:#24292E;">.options)</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// _parentVnode 为组件的 vnode</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">parentVnode</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> options._parentVnode</span></span>
<span class="line"><span style="color:#24292E;">  opts.parent </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> options.parent</span></span>
<span class="line"><span style="color:#24292E;">  opts._parentVnode </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> parentVnode</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">vnodeComponentOptions</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> parentVnode.componentOptions</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// 组件传值</span></span>
<span class="line"><span style="color:#24292E;">  opts.propsData </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> vnodeComponentOptions.propsData</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// 组件监听的事件</span></span>
<span class="line"><span style="color:#24292E;">  opts._parentListeners </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> vnodeComponentOptions.listeners</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// 组件内部的内容解析为 children。</span></span>
<span class="line"><span style="color:#24292E;">  opts._renderChildren </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> vnodeComponentOptions.children</span></span>
<span class="line"><span style="color:#24292E;">  opts._componentTag </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> vnodeComponentOptions.tag</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h2 id="子组件数据初始化" tabindex="-1">子组件数据初始化 <a class="header-anchor" href="#子组件数据初始化" aria-label="Permalink to &quot;子组件数据初始化&quot;">​</a></h2><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">export</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">initRender</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">vm</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Component</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">options</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> vm.$options</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">parentVnode</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> vm.$vnode </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> options._parentVnode</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">renderContext</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> parentVnode </span><span style="color:#F97583;">&amp;&amp;</span><span style="color:#E1E4E8;"> parentVnode.context</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// _renderChildren 为父组件调用子组件时子组件之间的节点。</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// 通过 resolveSlots方法 将 children 转换成 slots 形式</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// slots = { default: [Vnode1, Vnode2], [name]: [Vnode], ... }</span></span>
<span class="line"><span style="color:#E1E4E8;">  vm.$slots </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">resolveSlots</span><span style="color:#E1E4E8;">(options._renderChildren, renderContext)</span></span>
<span class="line"><span style="color:#E1E4E8;">  vm.$scopedSlots </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> emptyObject</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">export</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">resolveSlots</span><span style="color:#E1E4E8;">(</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#FFAB70;">children</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">?</span><span style="color:#B392F0;">Array</span><span style="color:#E1E4E8;">&lt;</span><span style="color:#B392F0;">VNode</span><span style="color:#E1E4E8;">&gt;,</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#FFAB70;">context</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">?</span><span style="color:#B392F0;">Component</span></span>
<span class="line"><span style="color:#E1E4E8;">)</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> { [</span><span style="color:#FFAB70;">key</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">string</span><span style="color:#E1E4E8;">]</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Array</span><span style="color:#E1E4E8;">&lt;</span><span style="color:#B392F0;">VNode</span><span style="color:#E1E4E8;">&gt; } {</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (</span><span style="color:#F97583;">!</span><span style="color:#E1E4E8;">children </span><span style="color:#F97583;">||</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">!</span><span style="color:#E1E4E8;">children.</span><span style="color:#79B8FF;">length</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> {}</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">slots</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> {}</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">for</span><span style="color:#E1E4E8;"> (</span><span style="color:#F97583;">let</span><span style="color:#E1E4E8;"> i </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">, l </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> children.</span><span style="color:#79B8FF;">length</span><span style="color:#E1E4E8;">;i </span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;"> l;i</span><span style="color:#F97583;">++</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">child</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> children[i]</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">data</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> child.data</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 删除 data.attrs.slot 属性</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (data </span><span style="color:#F97583;">&amp;&amp;</span><span style="color:#E1E4E8;"> data.attrs </span><span style="color:#F97583;">&amp;&amp;</span><span style="color:#E1E4E8;"> data.attrs.slot) {</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#F97583;">delete</span><span style="color:#E1E4E8;"> data.attrs.slot</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 如果 data.slot 存在，说明此时 slotScope 不存在（genData时处理的）</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> ((child.context </span><span style="color:#F97583;">===</span><span style="color:#E1E4E8;"> context </span><span style="color:#F97583;">||</span><span style="color:#E1E4E8;"> child.fnContext </span><span style="color:#F97583;">===</span><span style="color:#E1E4E8;"> context) </span><span style="color:#F97583;">&amp;&amp;</span></span>
<span class="line"><span style="color:#E1E4E8;">      data </span><span style="color:#F97583;">&amp;&amp;</span><span style="color:#E1E4E8;"> data.slot </span><span style="color:#F97583;">!=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">null</span></span>
<span class="line"><span style="color:#E1E4E8;">    ) {</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">name</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> data.slot</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">slot</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> (slots[name] </span><span style="color:#F97583;">||</span><span style="color:#E1E4E8;"> (slots[name] </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> []))</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (child.tag </span><span style="color:#F97583;">===</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;template&#39;</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">        slot.push.</span><span style="color:#B392F0;">apply</span><span style="color:#E1E4E8;">(slot, child.children </span><span style="color:#F97583;">||</span><span style="color:#E1E4E8;"> [])</span></span>
<span class="line"><span style="color:#E1E4E8;">      } </span><span style="color:#F97583;">else</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">        slot.</span><span style="color:#B392F0;">push</span><span style="color:#E1E4E8;">(child)</span></span>
<span class="line"><span style="color:#E1E4E8;">      }</span></span>
<span class="line"><span style="color:#E1E4E8;">    } </span><span style="color:#F97583;">else</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#6A737D;">// 其余的默认放到 default 中</span></span>
<span class="line"><span style="color:#E1E4E8;">      (slots.default </span><span style="color:#F97583;">||</span><span style="color:#E1E4E8;"> (slots.default </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> [])).</span><span style="color:#B392F0;">push</span><span style="color:#E1E4E8;">(child)</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// 忽略无用 slot</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">for</span><span style="color:#E1E4E8;"> (</span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">name</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">in</span><span style="color:#E1E4E8;"> slots) {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (slots[name].</span><span style="color:#B392F0;">every</span><span style="color:#E1E4E8;">(isWhitespace)) {</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#F97583;">delete</span><span style="color:#E1E4E8;"> slots[name]</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> slots</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">export</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">initRender</span><span style="color:#24292E;">(</span><span style="color:#E36209;">vm</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Component</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">options</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> vm.$options</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">parentVnode</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> vm.$vnode </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> options._parentVnode</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">renderContext</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> parentVnode </span><span style="color:#D73A49;">&amp;&amp;</span><span style="color:#24292E;"> parentVnode.context</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// _renderChildren 为父组件调用子组件时子组件之间的节点。</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// 通过 resolveSlots方法 将 children 转换成 slots 形式</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// slots = { default: [Vnode1, Vnode2], [name]: [Vnode], ... }</span></span>
<span class="line"><span style="color:#24292E;">  vm.$slots </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">resolveSlots</span><span style="color:#24292E;">(options._renderChildren, renderContext)</span></span>
<span class="line"><span style="color:#24292E;">  vm.$scopedSlots </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> emptyObject</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">export</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">resolveSlots</span><span style="color:#24292E;">(</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#E36209;">children</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">?</span><span style="color:#6F42C1;">Array</span><span style="color:#24292E;">&lt;</span><span style="color:#6F42C1;">VNode</span><span style="color:#24292E;">&gt;,</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#E36209;">context</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">?</span><span style="color:#6F42C1;">Component</span></span>
<span class="line"><span style="color:#24292E;">)</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> { [</span><span style="color:#E36209;">key</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">string</span><span style="color:#24292E;">]</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Array</span><span style="color:#24292E;">&lt;</span><span style="color:#6F42C1;">VNode</span><span style="color:#24292E;">&gt; } {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">!</span><span style="color:#24292E;">children </span><span style="color:#D73A49;">||</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">!</span><span style="color:#24292E;">children.</span><span style="color:#005CC5;">length</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> {}</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">slots</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> {}</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">for</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">let</span><span style="color:#24292E;"> i </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">, l </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> children.</span><span style="color:#005CC5;">length</span><span style="color:#24292E;">;i </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;"> l;i</span><span style="color:#D73A49;">++</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">child</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> children[i]</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">data</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> child.data</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// 删除 data.attrs.slot 属性</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (data </span><span style="color:#D73A49;">&amp;&amp;</span><span style="color:#24292E;"> data.attrs </span><span style="color:#D73A49;">&amp;&amp;</span><span style="color:#24292E;"> data.attrs.slot) {</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#D73A49;">delete</span><span style="color:#24292E;"> data.attrs.slot</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// 如果 data.slot 存在，说明此时 slotScope 不存在（genData时处理的）</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> ((child.context </span><span style="color:#D73A49;">===</span><span style="color:#24292E;"> context </span><span style="color:#D73A49;">||</span><span style="color:#24292E;"> child.fnContext </span><span style="color:#D73A49;">===</span><span style="color:#24292E;"> context) </span><span style="color:#D73A49;">&amp;&amp;</span></span>
<span class="line"><span style="color:#24292E;">      data </span><span style="color:#D73A49;">&amp;&amp;</span><span style="color:#24292E;"> data.slot </span><span style="color:#D73A49;">!=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">null</span></span>
<span class="line"><span style="color:#24292E;">    ) {</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">name</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> data.slot</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">slot</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> (slots[name] </span><span style="color:#D73A49;">||</span><span style="color:#24292E;"> (slots[name] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> []))</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (child.tag </span><span style="color:#D73A49;">===</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;template&#39;</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">        slot.push.</span><span style="color:#6F42C1;">apply</span><span style="color:#24292E;">(slot, child.children </span><span style="color:#D73A49;">||</span><span style="color:#24292E;"> [])</span></span>
<span class="line"><span style="color:#24292E;">      } </span><span style="color:#D73A49;">else</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">        slot.</span><span style="color:#6F42C1;">push</span><span style="color:#24292E;">(child)</span></span>
<span class="line"><span style="color:#24292E;">      }</span></span>
<span class="line"><span style="color:#24292E;">    } </span><span style="color:#D73A49;">else</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#6A737D;">// 其余的默认放到 default 中</span></span>
<span class="line"><span style="color:#24292E;">      (slots.default </span><span style="color:#D73A49;">||</span><span style="color:#24292E;"> (slots.default </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> [])).</span><span style="color:#6F42C1;">push</span><span style="color:#24292E;">(child)</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// 忽略无用 slot</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">for</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">name</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">in</span><span style="color:#24292E;"> slots) {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (slots[name].</span><span style="color:#6F42C1;">every</span><span style="color:#24292E;">(isWhitespace)) {</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#D73A49;">delete</span><span style="color:#24292E;"> slots[name]</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> slots</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h2 id="子组件slot使用" tabindex="-1">子组件slot使用 <a class="header-anchor" href="#子组件slot使用" aria-label="Permalink to &quot;子组件slot使用&quot;">​</a></h2><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#85E89D;">slot</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">name</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;header&quot;</span><span style="color:#E1E4E8;">&gt;&lt;/</span><span style="color:#85E89D;">slot</span><span style="color:#E1E4E8;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">slot</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">name</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;header&quot;</span><span style="color:#24292E;">&gt;&lt;/</span><span style="color:#22863A;">slot</span><span style="color:#24292E;">&gt;</span></span></code></pre></div><h2 id="子组件slot-parse" tabindex="-1">子组件slot parse <a class="header-anchor" href="#子组件slot-parse" aria-label="Permalink to &quot;子组件slot parse&quot;">​</a></h2><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">processSlotOutlet</span><span style="color:#E1E4E8;"> (</span><span style="color:#FFAB70;">el</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (el.tag </span><span style="color:#F97583;">===</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;slot&#39;</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 添加 slotName 属性</span></span>
<span class="line"><span style="color:#E1E4E8;">    el.slotName </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">getBindingAttr</span><span style="color:#E1E4E8;">(el, </span><span style="color:#9ECBFF;">&#39;name&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">processSlotOutlet</span><span style="color:#24292E;"> (</span><span style="color:#E36209;">el</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (el.tag </span><span style="color:#D73A49;">===</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;slot&#39;</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// 添加 slotName 属性</span></span>
<span class="line"><span style="color:#24292E;">    el.slotName </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">getBindingAttr</span><span style="color:#24292E;">(el, </span><span style="color:#032F62;">&#39;name&#39;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h2 id="子组件slot-generate" tabindex="-1">子组件slot generate <a class="header-anchor" href="#子组件slot-generate" aria-label="Permalink to &quot;子组件slot generate&quot;">​</a></h2><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">genSlot</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">el</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">ASTElement</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">state</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">CodegenState</span><span style="color:#E1E4E8;">)</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">string</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">slotName</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> el.slotName </span><span style="color:#F97583;">||</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;&quot;default&quot;&#39;</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// 默认的 children 节点</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">children</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">genChildren</span><span style="color:#E1E4E8;">(el, state)</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// _t 函数 </span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">let</span><span style="color:#E1E4E8;"> res </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">`_t(${</span><span style="color:#E1E4E8;">slotName</span><span style="color:#9ECBFF;">}${</span><span style="color:#E1E4E8;">children</span><span style="color:#9ECBFF;"> </span><span style="color:#F97583;">?</span><span style="color:#9ECBFF;"> </span><span style="color:#9ECBFF;">`,${</span><span style="color:#E1E4E8;">children</span><span style="color:#9ECBFF;">}`</span><span style="color:#9ECBFF;"> </span><span style="color:#F97583;">:</span><span style="color:#9ECBFF;"> </span><span style="color:#9ECBFF;">&#39;&#39;}`</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// 静态属性 + 动态绑定属性</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">attrs</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> el.attrs </span><span style="color:#F97583;">||</span><span style="color:#E1E4E8;"> el.dynamicAttrs</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">?</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">genProps</span><span style="color:#E1E4E8;">((el.attrs </span><span style="color:#F97583;">||</span><span style="color:#E1E4E8;"> []).</span><span style="color:#B392F0;">concat</span><span style="color:#E1E4E8;">(el.dynamicAttrs </span><span style="color:#F97583;">||</span><span style="color:#E1E4E8;"> []).</span><span style="color:#B392F0;">map</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">attr</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> ({</span></span>
<span class="line"><span style="color:#E1E4E8;">      name: </span><span style="color:#B392F0;">camelize</span><span style="color:#E1E4E8;">(attr.name),</span></span>
<span class="line"><span style="color:#E1E4E8;">      value: attr.value,</span></span>
<span class="line"><span style="color:#E1E4E8;">      dynamic: attr.dynamic</span></span>
<span class="line"><span style="color:#E1E4E8;">    })))</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">null</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">bind</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> el.attrsMap[</span><span style="color:#9ECBFF;">&#39;v-bind&#39;</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> ((attrs </span><span style="color:#F97583;">||</span><span style="color:#E1E4E8;"> bind) </span><span style="color:#F97583;">&amp;&amp;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">!</span><span style="color:#E1E4E8;">children) {</span></span>
<span class="line"><span style="color:#E1E4E8;">    res </span><span style="color:#F97583;">+=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">`,null`</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (attrs) {</span></span>
<span class="line"><span style="color:#E1E4E8;">    res </span><span style="color:#F97583;">+=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">`,${</span><span style="color:#E1E4E8;">attrs</span><span style="color:#9ECBFF;">}`</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (bind) {</span></span>
<span class="line"><span style="color:#E1E4E8;">    res </span><span style="color:#F97583;">+=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">`${</span><span style="color:#E1E4E8;">attrs</span><span style="color:#9ECBFF;"> </span><span style="color:#F97583;">?</span><span style="color:#9ECBFF;"> </span><span style="color:#9ECBFF;">&#39;&#39;</span><span style="color:#9ECBFF;"> </span><span style="color:#F97583;">:</span><span style="color:#9ECBFF;"> </span><span style="color:#9ECBFF;">&#39;,null&#39;},${</span><span style="color:#E1E4E8;">bind</span><span style="color:#9ECBFF;">}`</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> res </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;)&#39;</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">genSlot</span><span style="color:#24292E;">(</span><span style="color:#E36209;">el</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ASTElement</span><span style="color:#24292E;">, </span><span style="color:#E36209;">state</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">CodegenState</span><span style="color:#24292E;">)</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">string</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">slotName</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> el.slotName </span><span style="color:#D73A49;">||</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;&quot;default&quot;&#39;</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// 默认的 children 节点</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">children</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">genChildren</span><span style="color:#24292E;">(el, state)</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// _t 函数 </span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">let</span><span style="color:#24292E;"> res </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">`_t(${</span><span style="color:#24292E;">slotName</span><span style="color:#032F62;">}${</span><span style="color:#24292E;">children</span><span style="color:#032F62;"> </span><span style="color:#D73A49;">?</span><span style="color:#032F62;"> </span><span style="color:#032F62;">`,${</span><span style="color:#24292E;">children</span><span style="color:#032F62;">}`</span><span style="color:#032F62;"> </span><span style="color:#D73A49;">:</span><span style="color:#032F62;"> </span><span style="color:#032F62;">&#39;&#39;}`</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// 静态属性 + 动态绑定属性</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">attrs</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> el.attrs </span><span style="color:#D73A49;">||</span><span style="color:#24292E;"> el.dynamicAttrs</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">?</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">genProps</span><span style="color:#24292E;">((el.attrs </span><span style="color:#D73A49;">||</span><span style="color:#24292E;"> []).</span><span style="color:#6F42C1;">concat</span><span style="color:#24292E;">(el.dynamicAttrs </span><span style="color:#D73A49;">||</span><span style="color:#24292E;"> []).</span><span style="color:#6F42C1;">map</span><span style="color:#24292E;">(</span><span style="color:#E36209;">attr</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> ({</span></span>
<span class="line"><span style="color:#24292E;">      name: </span><span style="color:#6F42C1;">camelize</span><span style="color:#24292E;">(attr.name),</span></span>
<span class="line"><span style="color:#24292E;">      value: attr.value,</span></span>
<span class="line"><span style="color:#24292E;">      dynamic: attr.dynamic</span></span>
<span class="line"><span style="color:#24292E;">    })))</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">null</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">bind</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> el.attrsMap[</span><span style="color:#032F62;">&#39;v-bind&#39;</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> ((attrs </span><span style="color:#D73A49;">||</span><span style="color:#24292E;"> bind) </span><span style="color:#D73A49;">&amp;&amp;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">!</span><span style="color:#24292E;">children) {</span></span>
<span class="line"><span style="color:#24292E;">    res </span><span style="color:#D73A49;">+=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">`,null`</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (attrs) {</span></span>
<span class="line"><span style="color:#24292E;">    res </span><span style="color:#D73A49;">+=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">`,${</span><span style="color:#24292E;">attrs</span><span style="color:#032F62;">}`</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (bind) {</span></span>
<span class="line"><span style="color:#24292E;">    res </span><span style="color:#D73A49;">+=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">`${</span><span style="color:#24292E;">attrs</span><span style="color:#032F62;"> </span><span style="color:#D73A49;">?</span><span style="color:#032F62;"> </span><span style="color:#032F62;">&#39;&#39;</span><span style="color:#032F62;"> </span><span style="color:#D73A49;">:</span><span style="color:#032F62;"> </span><span style="color:#032F62;">&#39;,null&#39;},${</span><span style="color:#24292E;">bind</span><span style="color:#032F62;">}`</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> res </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;)&#39;</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h2 id="子组件-render" tabindex="-1">子组件 render <a class="header-anchor" href="#子组件-render" aria-label="Permalink to &quot;子组件 render&quot;">​</a></h2><h3 id="render" tabindex="-1">_render <a class="header-anchor" href="#render" aria-label="Permalink to &quot;_render&quot;">​</a></h3><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#79B8FF;">Vue</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">prototype</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">_render</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> ()</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">VNode</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">vm</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Component</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">this</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> { </span><span style="color:#79B8FF;">render</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">_parentVnode</span><span style="color:#E1E4E8;"> } </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> vm.$options</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (_parentVnode) {</span></span>
<span class="line"><span style="color:#E1E4E8;">    vm.$scopedSlots </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">normalizeScopedSlots</span><span style="color:#E1E4E8;">(</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#6A737D;">// 如果有插槽有 scope 的时候，scopedSlots存在</span></span>
<span class="line"><span style="color:#E1E4E8;">      _parentVnode.data.scopedSlots,</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#6A737D;">// initRender 解析出来的 slots，通过 children 转换而来</span></span>
<span class="line"><span style="color:#E1E4E8;">      vm.$slots,</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#6A737D;">// 当前的 scopedSlots</span></span>
<span class="line"><span style="color:#E1E4E8;">      vm.$scopedSlots</span></span>
<span class="line"><span style="color:#E1E4E8;">    )</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// ...</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">Vue</span><span style="color:#24292E;">.</span><span style="color:#005CC5;">prototype</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">_render</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> ()</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">VNode</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">vm</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Component</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">this</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> { </span><span style="color:#005CC5;">render</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">_parentVnode</span><span style="color:#24292E;"> } </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> vm.$options</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (_parentVnode) {</span></span>
<span class="line"><span style="color:#24292E;">    vm.$scopedSlots </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">normalizeScopedSlots</span><span style="color:#24292E;">(</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#6A737D;">// 如果有插槽有 scope 的时候，scopedSlots存在</span></span>
<span class="line"><span style="color:#24292E;">      _parentVnode.data.scopedSlots,</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#6A737D;">// initRender 解析出来的 slots，通过 children 转换而来</span></span>
<span class="line"><span style="color:#24292E;">      vm.$slots,</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#6A737D;">// 当前的 scopedSlots</span></span>
<span class="line"><span style="color:#24292E;">      vm.$scopedSlots</span></span>
<span class="line"><span style="color:#24292E;">    )</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// ...</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h3 id="normalizescopedslots" tabindex="-1">normalizeScopedSlots <a class="header-anchor" href="#normalizescopedslots" aria-label="Permalink to &quot;normalizeScopedSlots&quot;">​</a></h3><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">export</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">normalizeScopedSlots</span><span style="color:#E1E4E8;">(</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// 有 scope 时解析出来的 scopedSlots</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#FFAB70;">slots</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> { [</span><span style="color:#FFAB70;">key</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">string</span><span style="color:#E1E4E8;">]</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Function</span><span style="color:#E1E4E8;"> } </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">void</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// children 转换而来的 slots，都是没有 slotScope 的 slot</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#FFAB70;">normalSlots</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> { [</span><span style="color:#FFAB70;">key</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">string</span><span style="color:#E1E4E8;">]</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Array</span><span style="color:#E1E4E8;">&lt;</span><span style="color:#B392F0;">VNode</span><span style="color:#E1E4E8;">&gt; },</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// 当前组件的原来的 scopeSlots</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#FFAB70;">prevSlots</span><span style="color:#F97583;">?:</span><span style="color:#E1E4E8;"> { [</span><span style="color:#FFAB70;">key</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">string</span><span style="color:#E1E4E8;">]</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Function</span><span style="color:#E1E4E8;"> } </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">void</span></span>
<span class="line"><span style="color:#E1E4E8;">)</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">any</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">let</span><span style="color:#E1E4E8;"> res</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// 是否具有普通的 slots</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">hasNormalSlots</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> Object.</span><span style="color:#B392F0;">keys</span><span style="color:#E1E4E8;">(normalSlots).</span><span style="color:#79B8FF;">length</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// $stable 表示是否需要强制更新，不需要则为true</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">isStable</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> slots </span><span style="color:#F97583;">?</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">!!</span><span style="color:#E1E4E8;">slots.$stable </span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">!</span><span style="color:#E1E4E8;">hasNormalSlots</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">key</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> slots </span><span style="color:#F97583;">&amp;&amp;</span><span style="color:#E1E4E8;"> slots.$key</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (</span><span style="color:#F97583;">!</span><span style="color:#E1E4E8;">slots) {</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#6A737D;">// ...</span></span>
<span class="line"><span style="color:#E1E4E8;">  } </span><span style="color:#F97583;">else</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    res </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> {}</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">for</span><span style="color:#E1E4E8;"> (</span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">key</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">in</span><span style="color:#E1E4E8;"> slots) {</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (slots[key] </span><span style="color:#F97583;">&amp;&amp;</span><span style="color:#E1E4E8;"> key[</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">] </span><span style="color:#F97583;">!==</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;$&#39;</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;">// 用 scope 的覆盖 没有 scope 的</span></span>
<span class="line"><span style="color:#E1E4E8;">        res[key] </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">normalizeScopedSlot</span><span style="color:#E1E4E8;">(normalSlots, key, slots[key])</span></span>
<span class="line"><span style="color:#E1E4E8;">      }</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// 将普通的内容也转换成 scopedSlots 形式</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">for</span><span style="color:#E1E4E8;"> (</span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">key</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">in</span><span style="color:#E1E4E8;"> normalSlots) {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (</span><span style="color:#F97583;">!</span><span style="color:#E1E4E8;">(key </span><span style="color:#F97583;">in</span><span style="color:#E1E4E8;"> res)) {</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#6A737D;">// 将 normal 转变为函数形式</span></span>
<span class="line"><span style="color:#E1E4E8;">      res[key] </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">proxyNormalSlot</span><span style="color:#E1E4E8;">(normalSlots, key)</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// * 当前的插槽上面设置的属性</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">def</span><span style="color:#E1E4E8;">(res, </span><span style="color:#9ECBFF;">&#39;$stable&#39;</span><span style="color:#E1E4E8;">, isStable)</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">def</span><span style="color:#E1E4E8;">(res, </span><span style="color:#9ECBFF;">&#39;$key&#39;</span><span style="color:#E1E4E8;">, key)</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">def</span><span style="color:#E1E4E8;">(res, </span><span style="color:#9ECBFF;">&#39;$hasNormal&#39;</span><span style="color:#E1E4E8;">, hasNormalSlots)</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// res 里包含了</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> res</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">export</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">normalizeScopedSlots</span><span style="color:#24292E;">(</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// 有 scope 时解析出来的 scopedSlots</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#E36209;">slots</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> { [</span><span style="color:#E36209;">key</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">string</span><span style="color:#24292E;">]</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Function</span><span style="color:#24292E;"> } </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">void</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// children 转换而来的 slots，都是没有 slotScope 的 slot</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#E36209;">normalSlots</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> { [</span><span style="color:#E36209;">key</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">string</span><span style="color:#24292E;">]</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Array</span><span style="color:#24292E;">&lt;</span><span style="color:#6F42C1;">VNode</span><span style="color:#24292E;">&gt; },</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// 当前组件的原来的 scopeSlots</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#E36209;">prevSlots</span><span style="color:#D73A49;">?:</span><span style="color:#24292E;"> { [</span><span style="color:#E36209;">key</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">string</span><span style="color:#24292E;">]</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Function</span><span style="color:#24292E;"> } </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">void</span></span>
<span class="line"><span style="color:#24292E;">)</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">any</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">let</span><span style="color:#24292E;"> res</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// 是否具有普通的 slots</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">hasNormalSlots</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Object.</span><span style="color:#6F42C1;">keys</span><span style="color:#24292E;">(normalSlots).</span><span style="color:#005CC5;">length</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// $stable 表示是否需要强制更新，不需要则为true</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">isStable</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> slots </span><span style="color:#D73A49;">?</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">!!</span><span style="color:#24292E;">slots.$stable </span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">!</span><span style="color:#24292E;">hasNormalSlots</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">key</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> slots </span><span style="color:#D73A49;">&amp;&amp;</span><span style="color:#24292E;"> slots.$key</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">!</span><span style="color:#24292E;">slots) {</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#6A737D;">// ...</span></span>
<span class="line"><span style="color:#24292E;">  } </span><span style="color:#D73A49;">else</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    res </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> {}</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">for</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">key</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">in</span><span style="color:#24292E;"> slots) {</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (slots[key] </span><span style="color:#D73A49;">&amp;&amp;</span><span style="color:#24292E;"> key[</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">!==</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;$&#39;</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">// 用 scope 的覆盖 没有 scope 的</span></span>
<span class="line"><span style="color:#24292E;">        res[key] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">normalizeScopedSlot</span><span style="color:#24292E;">(normalSlots, key, slots[key])</span></span>
<span class="line"><span style="color:#24292E;">      }</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// 将普通的内容也转换成 scopedSlots 形式</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">for</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">key</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">in</span><span style="color:#24292E;"> normalSlots) {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">!</span><span style="color:#24292E;">(key </span><span style="color:#D73A49;">in</span><span style="color:#24292E;"> res)) {</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#6A737D;">// 将 normal 转变为函数形式</span></span>
<span class="line"><span style="color:#24292E;">      res[key] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">proxyNormalSlot</span><span style="color:#24292E;">(normalSlots, key)</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// * 当前的插槽上面设置的属性</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">def</span><span style="color:#24292E;">(res, </span><span style="color:#032F62;">&#39;$stable&#39;</span><span style="color:#24292E;">, isStable)</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">def</span><span style="color:#24292E;">(res, </span><span style="color:#032F62;">&#39;$key&#39;</span><span style="color:#24292E;">, key)</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">def</span><span style="color:#24292E;">(res, </span><span style="color:#032F62;">&#39;$hasNormal&#39;</span><span style="color:#24292E;">, hasNormalSlots)</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// res 里包含了</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> res</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h3 id="renderslot" tabindex="-1">renderSlot <a class="header-anchor" href="#renderslot" aria-label="Permalink to &quot;renderSlot&quot;">​</a></h3><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">export</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">renderSlot</span><span style="color:#E1E4E8;"> (</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#FFAB70;">name</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">string</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#FFAB70;">fallback</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">?</span><span style="color:#B392F0;">Array</span><span style="color:#E1E4E8;">&lt;</span><span style="color:#B392F0;">VNode</span><span style="color:#E1E4E8;">&gt;,</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#FFAB70;">props</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">?</span><span style="color:#B392F0;">Object</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#FFAB70;">bindObject</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">?</span><span style="color:#B392F0;">Object</span></span>
<span class="line"><span style="color:#E1E4E8;">)</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">?</span><span style="color:#B392F0;">Array</span><span style="color:#E1E4E8;">&lt;</span><span style="color:#B392F0;">VNode</span><span style="color:#E1E4E8;">&gt; {</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// 获取对应函数</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">scopedSlotFn</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">.$scopedSlots[name]</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">let</span><span style="color:#E1E4E8;"> nodes</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// 如果存在对应的函数</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (scopedSlotFn) { </span><span style="color:#6A737D;">// scoped slot</span></span>
<span class="line"><span style="color:#E1E4E8;">    props </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> props </span><span style="color:#F97583;">||</span><span style="color:#E1E4E8;"> {}</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (bindObject) {</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#6A737D;">// 处理参数</span></span>
<span class="line"><span style="color:#E1E4E8;">      props </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">extend</span><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">extend</span><span style="color:#E1E4E8;">({}, bindObject), props)</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 执行函数，返回 vnodes</span></span>
<span class="line"><span style="color:#E1E4E8;">    nodes </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">scopedSlotFn</span><span style="color:#E1E4E8;">(props) </span><span style="color:#F97583;">||</span><span style="color:#E1E4E8;"> fallback</span></span>
<span class="line"><span style="color:#E1E4E8;">  } </span><span style="color:#F97583;">else</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 如果找不到对应的 name，那么使用默认的 vnodes</span></span>
<span class="line"><span style="color:#E1E4E8;">    nodes </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">.$slots[name] </span><span style="color:#F97583;">||</span><span style="color:#E1E4E8;"> fallback</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">target</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> props </span><span style="color:#F97583;">&amp;&amp;</span><span style="color:#E1E4E8;"> props.slot</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (target) {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">$createElement</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;template&#39;</span><span style="color:#E1E4E8;">, { slot: target }, nodes)</span></span>
<span class="line"><span style="color:#E1E4E8;">  } </span><span style="color:#F97583;">else</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> nodes</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">export</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">renderSlot</span><span style="color:#24292E;"> (</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#E36209;">name</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">string</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#E36209;">fallback</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">?</span><span style="color:#6F42C1;">Array</span><span style="color:#24292E;">&lt;</span><span style="color:#6F42C1;">VNode</span><span style="color:#24292E;">&gt;,</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#E36209;">props</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">?</span><span style="color:#6F42C1;">Object</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#E36209;">bindObject</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">?</span><span style="color:#6F42C1;">Object</span></span>
<span class="line"><span style="color:#24292E;">)</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">?</span><span style="color:#6F42C1;">Array</span><span style="color:#24292E;">&lt;</span><span style="color:#6F42C1;">VNode</span><span style="color:#24292E;">&gt; {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// 获取对应函数</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">scopedSlotFn</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">this</span><span style="color:#24292E;">.$scopedSlots[name]</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">let</span><span style="color:#24292E;"> nodes</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// 如果存在对应的函数</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (scopedSlotFn) { </span><span style="color:#6A737D;">// scoped slot</span></span>
<span class="line"><span style="color:#24292E;">    props </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> props </span><span style="color:#D73A49;">||</span><span style="color:#24292E;"> {}</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (bindObject) {</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#6A737D;">// 处理参数</span></span>
<span class="line"><span style="color:#24292E;">      props </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">extend</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">extend</span><span style="color:#24292E;">({}, bindObject), props)</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// 执行函数，返回 vnodes</span></span>
<span class="line"><span style="color:#24292E;">    nodes </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">scopedSlotFn</span><span style="color:#24292E;">(props) </span><span style="color:#D73A49;">||</span><span style="color:#24292E;"> fallback</span></span>
<span class="line"><span style="color:#24292E;">  } </span><span style="color:#D73A49;">else</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// 如果找不到对应的 name，那么使用默认的 vnodes</span></span>
<span class="line"><span style="color:#24292E;">    nodes </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">this</span><span style="color:#24292E;">.$slots[name] </span><span style="color:#D73A49;">||</span><span style="color:#24292E;"> fallback</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">target</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> props </span><span style="color:#D73A49;">&amp;&amp;</span><span style="color:#24292E;"> props.slot</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (target) {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">this</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">$createElement</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;template&#39;</span><span style="color:#24292E;">, { slot: target }, nodes)</span></span>
<span class="line"><span style="color:#24292E;">  } </span><span style="color:#D73A49;">else</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> nodes</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h2 id="总结" tabindex="-1">总结 <a class="header-anchor" href="#总结" aria-label="Permalink to &quot;总结&quot;">​</a></h2><p>插槽在处理的时候主要分为两种类型：</p><ul><li>一种是带有<code>slotScope</code>的，此时具有参数传入。</li><li>一种是不带有<code>slotScope</code>，为普通插槽。</li></ul><p>在编译的时候：</p><ul><li>带有<code>slotScope</code>的转换为<code>scopedSlots</code>对象，存放到<code>component</code>组件的<code>vnode.data</code>里面：键为<code>slot name</code>，值为能生成<code>vnode</code>的函数（函数的参数与<code>scope</code>值一致）。</li><li>不带有<code>slotScope</code>的标记但是<code>slotTarget</code>存在，此时会标记<code>el.data.slot</code>为<code>true</code>。</li><li>对于组件下的内容，全部都会存放到<code>vnode.componentOptions.children</code>属性中。</li></ul><p>在子组件初始化的时候：</p><ul><li>用<code>vm.$options._renderChildren</code>表示<code>children</code>。</li><li>将<code>children</code>内容中存在<code>data.slot</code>的<code>child</code>，转化到<code>vm.$slots</code>属性当中，为<code>{ default: [Vnode1, Vnodee2] }</code>形式。</li></ul><p>在子组件渲染的时候：</p><ul><li>将<code>vm.$slots</code>与<code>vm.$scopedSlots</code>合并到<code>vm.$scopedSlots</code>，转换为<code>{ default: (props) =&gt; Vnodes}</code>的形式。</li><li>渲染<code>slot</code>组件时，根据<code>name</code>从<code>vm.$scopedSlots</code>中获取对应的函数，执行返回<code>vnodes</code>。</li></ul></div></div></main><footer class="VPDocFooter" data-v-6b87e69f data-v-ef5dee53><!--[--><!--]--><div class="edit-info" data-v-ef5dee53><div class="edit-link" data-v-ef5dee53><a class="VPLink link vp-external-link-icon no-icon edit-link-button" href="https://github.com/promise96319/promise96319.github.io/tree/master/docs/vue/插槽实现原理.md" target="_blank" rel="noreferrer" data-v-ef5dee53><!--[--><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="edit-link-icon" aria-label="edit icon" data-v-ef5dee53><path d="M18,23H4c-1.7,0-3-1.3-3-3V6c0-1.7,1.3-3,3-3h7c0.6,0,1,0.4,1,1s-0.4,1-1,1H4C3.4,5,3,5.4,3,6v14c0,0.6,0.4,1,1,1h14c0.6,0,1-0.4,1-1v-7c0-0.6,0.4-1,1-1s1,0.4,1,1v7C21,21.7,19.7,23,18,23z"></path><path d="M8,17c-0.3,0-0.5-0.1-0.7-0.3C7,16.5,6.9,16.1,7,15.8l1-4c0-0.2,0.1-0.3,0.3-0.5l9.5-9.5c1.2-1.2,3.2-1.2,4.4,0c1.2,1.2,1.2,3.2,0,4.4l-9.5,9.5c-0.1,0.1-0.3,0.2-0.5,0.3l-4,1C8.2,17,8.1,17,8,17zM9.9,12.5l-0.5,2.1l2.1-0.5l9.3-9.3c0.4-0.4,0.4-1.1,0-1.6c-0.4-0.4-1.2-0.4-1.6,0l0,0L9.9,12.5z M18.5,2.5L18.5,2.5L18.5,2.5z"></path></svg> Suggest changes to this page<!--]--></a></div><div class="last-updated" data-v-ef5dee53><p class="VPLastUpdated" data-v-ef5dee53 data-v-7e05ebdb>Last updated: <time datetime="2023-11-02T12:25:18.000Z" data-v-7e05ebdb></time></p></div></div><nav class="prev-next" data-v-ef5dee53><div class="pager" data-v-ef5dee53><a class="pager-link prev" href="/vue/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86%E4%B8%8B%E7%AF%87" data-v-ef5dee53><span class="desc" data-v-ef5dee53>Previous page</span><span class="title" data-v-ef5dee53>编译原理下篇</span></a></div><div class="pager" data-v-ef5dee53><a class="pager-link next" href="/vue/%E7%BB%84%E4%BB%B6%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86" data-v-ef5dee53><span class="desc" data-v-ef5dee53>Next page</span><span class="title" data-v-ef5dee53>组件实现原理</span></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><div class="footer" align="center"><a href="https://beian.miit.gov.cn/"> 鄂ICP备20002086号-1 </a></div><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"about_readme.md\":\"1dade529\",\"ai_index.md\":\"0af9e5b2\",\"ai_chatgpt-register.md\":\"ad644d36\",\"algorithms_树结构遍历.md\":\"303366c9\",\"ai_paddlepaddle_install.md\":\"85f74c15\",\"about_plan.md\":\"5b86affd\",\"data-structures_index.md\":\"b26c7a64\",\"about_index.md\":\"90a309b4\",\"algorithms_index.md\":\"9d16e23d\",\"data-structures_二叉查找树.md\":\"05aee946\",\"algorithms_阅读资料.md\":\"a859b6b9\",\"articles_index.md\":\"32c68f0a\",\"algorithms_二叉树.md\":\"8bd0bae6\",\"config_draw-io.md\":\"91d91736\",\"config_index.md\":\"55698abc\",\"data-structures_红黑树.md\":\"79f2e836\",\"articles_react-concurrency.md\":\"a3656d6a\",\"react_updatequeue.md\":\"4412e885\",\"data-structures_字典树.md\":\"c75a63e5\",\"network_缓存.md\":\"ca180eaf\",\"network_应用层.md\":\"95ee1d0f\",\"node_esm.md\":\"4073be0b\",\"node_compose.md\":\"37b338a4\",\"rollup_split-code.md\":\"463cecad\",\"algorithms_字符串.md\":\"cc329139\",\"babel_resource.md\":\"05e7f9e5\",\"articles_tree-shaking.md\":\"d34a43cf\",\"babel_guide_plugin.md\":\"2a907094\",\"babel_index.md\":\"b8b3319d\",\"config_vscode.md\":\"6d99b7e1\",\"babel_guide_overview.md\":\"731c1920\",\"articles_react-event.md\":\"6d16d0bf\",\"algorithms_动态规划.md\":\"5421ad7f\",\"babel_problems_invalid-polyfill.md\":\"677aa9de\",\"algorithms_数组.md\":\"9c11a710\",\"algorithms_排序汇总.md\":\"4521b676\",\"config_bash.md\":\"42d6f44c\",\"network_index.md\":\"65e37789\",\"articles_module.md\":\"12ec7dcd\",\"react_阅读资料.md\":\"05d8f95b\",\"network_运输层.md\":\"a04aedc4\",\"resources_前端博客.md\":\"d8b299be\",\"resources_index.md\":\"1bdecb27\",\"node_buffer.md\":\"a5aedf86\",\"resources_小程序.md\":\"f9970db1\",\"network_阅读资料.md\":\"d1875803\",\"rollup_index.md\":\"7a693d5d\",\"node_index.md\":\"de3ce5f5\",\"resources_知识点.md\":\"b0410cda\",\"rollup_plugin.md\":\"04123054\",\"node_module.md\":\"653485cd\",\"rollup_note.md\":\"4fa0ea6f\",\"node_package.md\":\"a915ecb1\",\"rollup_scope-hoist.md\":\"8b2a273c\",\"rollup_todo.md\":\"5336d54e\",\"node_资料.md\":\"c586c908\",\"rollup_tree-shaking.md\":\"b8397acc\",\"node_stream.md\":\"06c18f88\",\"node_cjs.md\":\"6f11c253\",\"rollup_源码调试.md\":\"a8a4502f\",\"server_https.md\":\"62d335e6\",\"rust_index.md\":\"de6c29e6\",\"passion_windows-ubuntu.md\":\"271d2918\",\"node_手写简版express.md\":\"67d1d193\",\"node_进程与线程.md\":\"b331ca2c\",\"project_drawer.md\":\"978eb6e6\",\"project_index.md\":\"4901bd65\",\"project_css-media.md\":\"758068a8\",\"project_ellipsis-text.md\":\"403fad27\",\"project_infra_sourcemap.md\":\"639c0826\",\"project_infra_compatibility.md\":\"4f65a59e\",\"project_prefix-cls.md\":\"dba74144\",\"project_react-runtime.md\":\"c961c59c\",\"project_space.md\":\"dc8de6fc\",\"react_fiber.md\":\"a6043f7b\",\"config_vim.md\":\"96da122b\",\"react_lanes模型.md\":\"7517db47\",\"data-structures_堆.md\":\"6e64d75d\",\"data-structures_布隆过滤器.md\":\"8a6df730\",\"data-structures_哈希表.md\":\"cc2ab296\",\"data-structures_平衡二叉树.md\":\"d18e149f\",\"data-structures_并查集.md\":\"8b23417c\",\"data-structures_树状数组.md\":\"5a53ea12\",\"articles_react-rerender.md\":\"552b21a9\",\"data-structures_线段树.md\":\"94352dc7\",\"design-pattern_创建型模式.md\":\"8fb51ee7\",\"project_virtual-list.md\":\"a7ac2e26\",\"design-pattern_index.md\":\"e4972f3f\",\"index.md\":\"8cc15fe2\",\"design-pattern_阅读资料.md\":\"828a0bc9\",\"javascript_typescript.md\":\"1c80dd66\",\"javascript_index.md\":\"772a678c\",\"javascript_es6.md\":\"8f711578\",\"javascript_co库.md\":\"e364323b\",\"javascript_input宽度问题.md\":\"de289434\",\"javascript_js继承.md\":\"acaa704f\",\"javascript_函数式编程.md\":\"0564f05e\",\"javascript_事件循环机制.md\":\"2684ec68\",\"project_semi-design.md\":\"f3115bc0\",\"leetcode_21-40.md\":\"459581fe\",\"javascript_js方法实现.md\":\"037b34d8\",\"javascript_正则.md\":\"fce6b5f4\",\"leetcode_index.md\":\"42d14d0a\",\"react_渲染.md\":\"b75b097f\",\"leetcode_1-20.md\":\"b66037f6\",\"react_suspense实现.md\":\"a680d824\",\"javascript_手写promise.md\":\"f967395a\",\"server_mongodb.md\":\"ec9debba\",\"tools_draw-io.md\":\"499cbbd5\",\"tools_github-workflow.md\":\"ed3c6a83\",\"tools_index.md\":\"8fcb5210\",\"trend_jiti.md\":\"0cf1ca33\",\"trend_mini-program.md\":\"4539ae6f\",\"trend_micro-frontend.md\":\"96582793\",\"trend_monorepo.md\":\"d96baece\",\"trend_native.md\":\"b287561c\",\"trend_solidjs.md\":\"f27a5cb1\",\"trend_web-assembly.md\":\"3ae4836a\",\"typescript_index.md\":\"5044fd78\",\"typescript_utility-types.md\":\"c441e33d\",\"trend_data-visualization.md\":\"99f221b2\",\"vite_源码调试.md\":\"0fcede6b\",\"vue_index.md\":\"6081d3f3\",\"vue_一些原理汇总.md\":\"03b22c2b\",\"vite_index.md\":\"f69753cc\",\"vue_编译原理上篇.md\":\"ec45830c\",\"project_css-background-img.md\":\"9049f7fa\",\"react_学习计划.md\":\"ebfb56f1\",\"server_index.md\":\"e3f73380\",\"vue_阅读资料.md\":\"6c6c8ef1\",\"algorithms_回溯法.md\":\"80b3c4a2\",\"project_auto-import.md\":\"7c8e3b24\",\"react_react源码调试-next.md\":\"28fd2f1f\",\"project_css-hack.md\":\"c85f41ae\",\"design-pattern_行为型模式.md\":\"cf8a5f5e\",\"design-pattern_结构型模式.md\":\"dc59cb47\",\"tools_iterm2-ohmyzsh.md\":\"d104d7f5\",\"tools_img-library.md\":\"d73dda1c\",\"tools_jenkins.md\":\"f6648604\",\"trend_index.md\":\"ad46f4e2\",\"tools_software.md\":\"d3015b61\",\"react_手写简版redux.md\":\"8a83e772\",\"react_浏览器一帧里做了什么.md\":\"335e2132\",\"vue_编译原理中篇.md\":\"f91d9585\",\"vue_手写简版vuex.md\":\"72830037\",\"webpack_tapable.md\":\"b4b94474\",\"react_react源码调试.md\":\"461164c2\",\"react_completework.md\":\"ab6b6af6\",\"webpack_module-federation.md\":\"1b43f398\",\"react_hooks实现.md\":\"255f5354\",\"webpack_流程开始.md\":\"1a328380\",\"webpack_webpack源码调试.md\":\"2736fd88\",\"react_react源码起始篇.md\":\"aeb5a5ca\",\"vue_插槽实现原理.md\":\"65963408\",\"vue_响应式原理上篇.md\":\"2b983660\",\"trend_bundleless.md\":\"2623138c\",\"react_任务调度.md\":\"502cb55e\",\"react_index.md\":\"3c34d1b8\",\"react_commitwork.md\":\"31eea140\",\"webpack_emit阶段.md\":\"6602cc10\",\"webpack_import.md\":\"f93a68b4\",\"webpack_index.md\":\"cc3695d7\",\"vite_record.md\":\"fd28ca8b\",\"react_beginwork-fiber创建.md\":\"aaf16275\",\"webpack_webpack优化.md\":\"3cb250b1\",\"webpack_splitchunksplugin.md\":\"c942c5c9\",\"webpack_vue-loader实现.md\":\"d569381e\",\"react_事件系统.md\":\"bf21e376\",\"articles_react-ssr_index.md\":\"9ea13e47\",\"vue_选项合并.md\":\"a7675af6\",\"vue_响应式原理下篇.md\":\"de6113d0\",\"webpack_guide.md\":\"1442cfb4\",\"react_react热更新实现原理.md\":\"9a02a535\",\"vue_手写简版vuerouter.md\":\"74bcb5e0\",\"webpack_官方文档.md\":\"796b4811\",\"vue_组成与设计.md\":\"4ae78b7d\",\"webpack_runtime.md\":\"5c8c900a\",\"webpack_make阶段.md\":\"dd70ac7c\",\"webpack_watch实现.md\":\"8eeacdfd\",\"webpack_addmodule.md\":\"2ce54013\",\"vue_最长递增子序列.md\":\"9ed26507\",\"javascript_元素位置获取.md\":\"df4403be\",\"vue_组件实现原理.md\":\"3793c0b1\",\"webpack_webpack官方文档.md\":\"9cc04bb2\",\"webpack_treeshaking原理.md\":\"a27e00a0\",\"react_手写简版react-redux.md\":\"5f9da3f2\",\"vue3_index.md\":\"eed23a56\",\"react_beginwork-fiber更新.md\":\"f7ac6ef5\",\"react_note_event-change.md\":\"d5e962c6\",\"vue3_源码调试.md\":\"d1578f28\",\"vue_编译原理下篇.md\":\"c4b0da4c\",\"webpack_factorizemodule.md\":\"038d8ca8\",\"webpack_seal阶段.md\":\"225eeb84\",\"webpack_buildmodule.md\":\"647fe406\",\"vue_响应式原理中篇.md\":\"171130c8\",\"webpack_热更新实现原理.md\":\"5c09a8d6\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"zh-CN\",\"dir\":\"ltr\",\"title\":\"promise96319\",\"description\":\"前端开发\",\"base\":\"/\",\"head\":[],\"appearance\":true,\"themeConfig\":{\"logo\":\"/logo.png\",\"nav\":[{\"text\":\"文章\",\"link\":\"/articles/index\"},{\"text\":\"AI\",\"link\":\"/ai/index\"},{\"text\":\"框架系列\",\"items\":[{\"text\":\"Vue v2 源码\",\"link\":\"/vue/\"},{\"text\":\"Vue v3 源码\",\"link\":\"/vue3/\"},{\"text\":\"React v17 源码\",\"link\":\"/react/\"}]},{\"text\":\"基建系列\",\"items\":[{\"text\":\"Webpack 系列\",\"link\":\"/webpack/\"},{\"text\":\"Rollup 系列\",\"link\":\"/rollup/\"},{\"text\":\"Vite 系列\",\"link\":\"/vite/\"},{\"text\":\"Babel 系列\",\"link\":\"/babel/\"}]},{\"text\":\"JS 系列\",\"items\":[{\"text\":\"ES6\",\"link\":\"/javascript/\"},{\"text\":\"Node\",\"link\":\"/node/\"},{\"text\":\"Typescript\",\"link\":\"/typescript/\"}]},{\"text\":\"计算机基础\",\"items\":[{\"text\":\"算法\",\"link\":\"/algorithms/\"},{\"text\":\"数据结构\",\"link\":\"/data-structures/\"},{\"text\":\"设计模式\",\"link\":\"/design-pattern/\"},{\"text\":\"网络\",\"link\":\"/network/\"},{\"text\":\"LeetCode\",\"link\":\"/leetcode/\"}]},{\"text\":\"开发\",\"items\":[{\"text\":\"工具\",\"link\":\"/tools/\"},{\"text\":\"配置\",\"link\":\"/config/\"},{\"text\":\"资料\",\"link\":\"/resources/\"},{\"text\":\"项目\",\"link\":\"/project/\"}]}],\"sidebar\":{\"/articles/\":[{\"text\":\"文章\",\"items\":[{\"text\":\"React 并发原理\",\"link\":\"/articles/react-concurrency\"}]}],\"/ai/\":[{\"text\":\"AI\",\"items\":[{\"text\":\"ChatGPT Register\",\"link\":\"/ai/chatgpt-register\"}]}],\"/vue/\":[{\"text\":\"Vue2原理\",\"collapsed\":false,\"items\":[{\"text\":\"组成与设计\",\"link\":\"/vue/组成与设计\"},{\"text\":\"选项合并\",\"link\":\"/vue/选项合并\"},{\"text\":\"响应式原理上篇\",\"link\":\"/vue/响应式原理上篇\"},{\"text\":\"响应式原理中篇\",\"link\":\"/vue/响应式原理中篇\"},{\"text\":\"响应式原理下篇\",\"link\":\"/vue/响应式原理下篇\"},{\"text\":\"编译原理上篇\",\"link\":\"/vue/编译原理上篇\"},{\"text\":\"编译原理中篇\",\"link\":\"/vue/编译原理中篇\"},{\"text\":\"编译原理下篇\",\"link\":\"/vue/编译原理下篇\"},{\"text\":\"插槽实现原理\",\"link\":\"/vue/插槽实现原理\"},{\"text\":\"组件实现原理\",\"link\":\"/vue/组件实现原理\"},{\"text\":\"一些原理汇总\",\"link\":\"/vue/一些原理汇总\"},{\"text\":\"手写简版Vuex\",\"link\":\"/vue/手写简版Vuex\"},{\"text\":\"手写简版VueRouter\",\"link\":\"/vue/手写简版VueRouter\"},{\"text\":\"阅读资料\",\"link\":\"/vue/阅读资料.md\"}]}],\"/vue3/\":[{\"text\":\"Vue3原理\",\"items\":[{\"text\":\"源码调试\",\"link\":\"/vue3/源码调试\"}]}],\"/react/\":[{\"text\":\"原理\",\"collapsed\":false,\"items\":[{\"text\":\"react源码调试环境构建\",\"link\":\"/react/react源码调试-next\"},{\"text\":\"react源码调试\",\"link\":\"/react/react源码调试\"},{\"text\":\"react源码起始篇\",\"link\":\"/react/react源码起始篇\"},{\"text\":\"Lanes模型\",\"link\":\"/react/Lanes模型\"},{\"text\":\"Fiber\",\"link\":\"/react/Fiber\"},{\"text\":\"浏览器一帧里做了什么\",\"link\":\"/react/浏览器一帧里做了什么\"},{\"text\":\"任务调度\",\"link\":\"/react/任务调度\"},{\"text\":\"UpdateQueue\",\"link\":\"/react/UpdateQueue\"},{\"text\":\"beginWork-fiber创建\",\"link\":\"/react/beginWork-fiber创建\"},{\"text\":\"beginWork-fiber更新\",\"link\":\"/react/beginWork-fiber更新\"},{\"text\":\"completeWork\",\"link\":\"/react/completeWork\"},{\"text\":\"hooks实现\",\"link\":\"/react/hooks实现\"},{\"text\":\"commitWork\",\"link\":\"/react/commitWork\"},{\"text\":\"Suspense实现\",\"link\":\"/react/Suspense实现\"},{\"text\":\"事件系统\",\"link\":\"/react/事件系统\"},{\"text\":\"手写简版redux\",\"link\":\"/react/手写简版redux\"},{\"text\":\"手写简版react-redux\",\"link\":\"/react/手写简版react-redux\"},{\"text\":\"阅读资料\",\"link\":\"/react/阅读资料\"}]},{\"text\":\"知识点\",\"collapsed\":false,\"items\":[{\"text\":\"不同版本React事件机制\",\"link\":\"/react/note/event-change\"}]}],\"/webpack/\":[{\"text\":\"理论\",\"collapsed\":false,\"items\":[{\"text\":\"指南\",\"link\":\"/webpack/guide\"}]},{\"text\":\"原理\",\"link\":\"/webpack/index\",\"collapsed\":false,\"items\":[{\"text\":\"webpack源码调试\",\"link\":\"/webpack/webpack源码调试\"},{\"text\":\"流程开始\",\"link\":\"/webpack/流程开始\"},{\"text\":\"make阶段\",\"link\":\"/webpack/make阶段\"},{\"text\":\"factorizeModule\",\"link\":\"/webpack/factorizeModule\"},{\"text\":\"addModule\",\"link\":\"/webpack/addModule\"},{\"text\":\"buildModule\",\"link\":\"/webpack/buildModule\"},{\"text\":\"seal阶段\",\"link\":\"/webpack/seal阶段\"},{\"text\":\"emit阶段\",\"link\":\"/webpack/emit阶段\"},{\"text\":\"import\",\"link\":\"/webpack/import\"},{\"text\":\"TreeShaking原理\",\"link\":\"/webpack/TreeShaking原理\"},{\"text\":\"SplitChunksPlugin\",\"link\":\"/webpack/SplitChunksPlugin\"},{\"text\":\"watch实现\",\"link\":\"/webpack/watch实现\"},{\"text\":\"vue-loader实现\",\"link\":\"/webpack/vue-loader实现\"},{\"text\":\"热更新实现原理\",\"link\":\"/webpack/热更新实现原理\"},{\"text\":\"Tapable\",\"link\":\"/webpack/Tapable\"},{\"text\":\"webpack优化\",\"link\":\"/webpack/webpack优化\"},{\"text\":\"webpack官方文档\",\"link\":\"/webpack/webpack官方文档\"}]}],\"/rollup/\":[{\"collapsed\":false,\"text\":\"原理\",\"items\":[{\"text\":\"源码调试\",\"link\":\"/rollup/源码调试\"},{\"text\":\"scope-hoist\",\"link\":\"/rollup/scope-hoist\"},{\"text\":\"split-code\",\"link\":\"/rollup/split-code\"},{\"text\":\"tree-shaking\",\"link\":\"/rollup/tree-shaking\"},{\"text\":\"todo\",\"link\":\"/rollup/todo\"}]}],\"/vite/\":[{\"text\":\"原理\",\"items\":[{\"text\":\"源码调试\",\"link\":\"/vite/源码调试\"}]}],\"/babel/\":[{\"text\":\"入门\",\"collapse\":false,\"items\":[{\"text\":\"概览\",\"link\":\"/babel/guide/overview\"},{\"text\":\"插件开发\",\"link\":\"/babel/guide/plugin\"}]},{\"text\":\"实际问题\",\"collapse\":false,\"items\":[{\"text\":\"项目产物兼容性问题\",\"link\":\"/babel/problems/invalid-polyfill\"}]},{\"text\":\"阅读资料\",\"link\":\"/babel/resource\"}],\"/javascript/\":[{\"text\":\"ES6\",\"collapsed\":false,\"items\":[{\"text\":\"事件循环机制\",\"link\":\"/javascript/事件循环机制\"},{\"text\":\"浏览器一帧里做了什么\",\"link\":\"/javascript/../react/浏览器一帧里做了什么\"},{\"text\":\"手写Promise\",\"link\":\"/javascript/手写Promise\"},{\"text\":\"co库\",\"link\":\"/javascript/co库\"},{\"text\":\"js继承\",\"link\":\"/javascript/js继承\"},{\"text\":\"js方法实现\",\"link\":\"/javascript/js方法实现\"},{\"text\":\"es6\",\"link\":\"/javascript/es6\"},{\"text\":\"元素位置获取\",\"link\":\"/javascript/元素位置获取\"},{\"text\":\"Input宽度问题\",\"link\":\"/javascript/Input宽度问题\"}]}],\"/typescript/\":[{\"text\":\"typescript\",\"items\":[{\"link\":\"/typescript/utility-types\",\"text\":\"内置类型\"}]}],\"/node/\":[{\"text\":\"node\",\"items\":[{\"text\":\"手写简版express\",\"link\":\"/node/手写简版express\"},{\"text\":\"compose\",\"link\":\"/node/compose\"},{\"text\":\"进程与线程\",\"link\":\"/node/进程与线程\"},{\"text\":\"资料\",\"link\":\"/node/资料\"},{\"text\":\"cjs\",\"link\":\"/node/cjs\"},{\"text\":\"esm\",\"link\":\"/node/esm\"},{\"text\":\"module\",\"link\":\"/node/module\"},{\"text\":\"package\",\"link\":\"/node/package\"}]}],\"/algorithms/\":[{\"text\":\"算法\",\"collapsed\":false,\"items\":[{\"text\":\"动态规划\",\"link\":\"/algorithms/动态规划\"},{\"text\":\"回溯法\",\"link\":\"/algorithms/回溯法\"},{\"text\":\"排序汇总\",\"link\":\"/algorithms/排序汇总\"},{\"text\":\"数组\",\"link\":\"/algorithms/数组\"},{\"text\":\"字符串\",\"link\":\"/algorithms/字符串\"},{\"text\":\"二叉树\",\"link\":\"/algorithms/二叉树\"}]},{\"text\":\"阅读资料\",\"link\":\"/algorithms/阅读资料\"}],\"/leetcode/\":[{\"text\":\"leetcode\",\"items\":[{\"link\":\"/leetcode/1-20\",\"text\":\"1-20\"},{\"link\":\"/leetcode/21-40\",\"text\":\"21-40\"}]}],\"/data-structures/\":[{\"text\":\"数据结构\",\"collapsed\":false,\"items\":[{\"link\":\"/data-structures/树状数组\",\"text\":\"树状数组\"},{\"link\":\"/data-structures/线段树\",\"text\":\"线段树\"},{\"link\":\"/data-structures/红黑树\",\"text\":\"红黑树\"},{\"link\":\"/data-structures/平衡二叉树\",\"text\":\"平衡二叉树\"},{\"link\":\"/data-structures/二叉查找树\",\"text\":\"二叉查找树\"},{\"link\":\"/data-structures/堆\",\"text\":\"堆\"},{\"link\":\"/data-structures/哈希表\",\"text\":\"哈希表\"},{\"link\":\"/data-structures/字典树\",\"text\":\"字典树\"},{\"link\":\"/data-structures/并查集\",\"text\":\"并查集\"},{\"link\":\"/data-structures/布隆过滤器\",\"text\":\"布隆过滤器\"}]}],\"/design-pattern/\":[{\"text\":\"设计模式\",\"items\":[{\"link\":\"/design-pattern/创建型模式\",\"text\":\"创建型模式\"},{\"link\":\"/design-pattern/结构型模式\",\"text\":\"结构型模式\"},{\"link\":\"/design-pattern/行为型模式\",\"text\":\"行为型模式\"},{\"link\":\"/design-pattern/阅读资料\",\"text\":\"阅读资料\"}]}],\"/trend/\":[{\"text\":\"新技术\",\"items\":[{\"link\":\"/trend/bundle\",\"text\":\"bundleless\"}]}],\"/network/\":[{\"text\":\"网络\",\"items\":[{\"link\":\"/network/运输层\",\"text\":\"运输层\"},{\"link\":\"/network/应用层\",\"text\":\"应用层\"},{\"link\":\"/network/缓存\",\"text\":\"缓存\"}]},{\"text\":\"阅读资料\",\"link\":\"/network/阅读资料\"}],\"/resources/\":[{\"text\":\"资源\",\"items\":[{\"link\":\"/resources/前端博客\",\"text\":\"前端博客\"},{\"link\":\"/resources/知识点\",\"text\":\"知识点\"}]}],\"/tools/\":[{\"text\":\"工具\",\"items\":[{\"link\":\"/tools/img-library\",\"text\":\"img library\"},{\"link\":\"/tools/iterm2-ohmyzsh\",\"text\":\"iterm2 + ohmyzsh\"},{\"link\":\"/tools/jenkins\",\"text\":\"jenkins\"},{\"link\":\"/tools/github-workflow\",\"text\":\"github workflow\"}]}],\"/config/\":[{\"text\":\"个人配置\",\"items\":[{\"link\":\"/config/draw-io\",\"text\":\"draw.io\"},{\"link\":\"/config/bash\",\"text\":\"bash\"},{\"link\":\"/config/vim\",\"text\":\"vim\"}]}],\"/project/\":[{\"text\":\"@qt/design\",\"collapsed\":false,\"items\":[{\"link\":\"/project/react-runtime\",\"text\":\"组件库 Playground\"},{\"link\":\"/project/prefix-cls\",\"text\":\"组件库样式覆盖问题\"},{\"link\":\"/project/css-background-img\",\"text\":\"CSS 背景图片设置颜色\"},{\"link\":\"/project/css-media\",\"text\":\"媒体查询\"},{\"link\":\"/project/auto-import\",\"text\":\"自动引入\"},{\"link\":\"/project/ellipsis-text\",\"text\":\"省略文本\"},{\"link\":\"/project/virtual-list\",\"text\":\"虚拟滚动\"},{\"link\":\"/project/drawer\",\"text\":\"抽屉嵌套位移\"},{\"link\":\"/project/space\",\"text\":\"间距\"},{\"link\":\"/project/semi-design\",\"text\":\"Semi Design 架构\"}]},{\"text\":\"OS 项目\",\"items\":[{\"link\":\"/project/infra/compatibility\",\"text\":\"项目产物兼容性问题\"},{\"link\":\"/project/infra/sourcemap\",\"text\":\"Sourcemap 调试\"}]}]},\"outline\":[2,3],\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/promise96319\"}],\"editLink\":{\"pattern\":\"https://github.com/promise96319/promise96319.github.io/tree/master/docs/:path\",\"text\":\"Suggest changes to this page\"},\"algolia\":{\"appId\":\"ME3PPTXK7S\",\"apiKey\":\"3ff6e86abc1d6b6def15d19bca7c8067\",\"indexName\":\"qinguanghui\"}},\"locales\":{},\"scrollOffset\":90,\"cleanUrls\":true}");</script>
    
  </body>
</html>