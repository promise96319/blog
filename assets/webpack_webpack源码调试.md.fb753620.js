import{_ as s,o as a,c as n,Q as o}from"./chunks/framework.92ce8a2a.js";const p="/assets/chrome-inspect-01.f07d063c.jpg",e="/assets/chrome-inspect-02.0c772fbe.jpg",l="/assets/chrome-vscode-debugger.51d16334.png",k=JSON.parse('{"title":"webpack 源码调试","description":"","frontmatter":{},"headers":[],"relativePath":"webpack/webpack源码调试.md","filePath":"webpack/webpack源码调试.md","lastUpdated":1695640069000}'),c={name:"webpack/webpack源码调试.md"},t=o(`<h1 id="webpack-源码调试" tabindex="-1">webpack 源码调试 <a class="header-anchor" href="#webpack-源码调试" aria-label="Permalink to &quot;webpack 源码调试&quot;">​</a></h1><h2 id="安装webpack-webpack-cli" tabindex="-1">安装webpack/webpack-cli <a class="header-anchor" href="#安装webpack-webpack-cli" aria-label="Permalink to &quot;安装webpack/webpack-cli&quot;">​</a></h2><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#9ECBFF;">&quot;devDependencies&quot;</span><span style="color:#E1E4E8;">: {</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">&quot;webpack&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;^5.33.2&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">&quot;webpack-cli&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;^4.6.0&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#032F62;">&quot;devDependencies&quot;</span><span style="color:#24292E;">: {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#032F62;">&quot;webpack&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;^5.33.2&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#032F62;">&quot;webpack-cli&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;^4.6.0&quot;</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h2 id="添加inspect" tabindex="-1">添加inspect <a class="header-anchor" href="#添加inspect" aria-label="Permalink to &quot;添加inspect&quot;">​</a></h2><p>找到<code>node_modules/.bin/</code>目录，分别在<code>webpack.js</code>和<code>webpack-cli.js</code>文件的首行后面添加<code>--inspect-brk</code>：</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">// 添加前</span></span>
<span class="line"><span style="color:#E1E4E8;">#</span><span style="color:#F97583;">!/</span><span style="color:#E1E4E8;">usr</span><span style="color:#F97583;">/</span><span style="color:#E1E4E8;">bin</span><span style="color:#F97583;">/</span><span style="color:#E1E4E8;">env node</span></span>
<span class="line"><span style="color:#6A737D;">// 添加后</span></span>
<span class="line"><span style="color:#E1E4E8;">#</span><span style="color:#F97583;">!/</span><span style="color:#E1E4E8;">usr</span><span style="color:#F97583;">/</span><span style="color:#E1E4E8;">bin</span><span style="color:#F97583;">/</span><span style="color:#E1E4E8;">env node </span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">inspect</span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">brk</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">// 添加前</span></span>
<span class="line"><span style="color:#24292E;">#</span><span style="color:#D73A49;">!/</span><span style="color:#24292E;">usr</span><span style="color:#D73A49;">/</span><span style="color:#24292E;">bin</span><span style="color:#D73A49;">/</span><span style="color:#24292E;">env node</span></span>
<span class="line"><span style="color:#6A737D;">// 添加后</span></span>
<span class="line"><span style="color:#24292E;">#</span><span style="color:#D73A49;">!/</span><span style="color:#24292E;">usr</span><span style="color:#D73A49;">/</span><span style="color:#24292E;">bin</span><span style="color:#D73A49;">/</span><span style="color:#24292E;">env node </span><span style="color:#D73A49;">--</span><span style="color:#24292E;">inspect</span><span style="color:#D73A49;">-</span><span style="color:#24292E;">brk</span></span></code></pre></div><h2 id="运行webpack" tabindex="-1">运行webpack <a class="header-anchor" href="#运行webpack" aria-label="Permalink to &quot;运行webpack&quot;">​</a></h2><p>定义<code>webpack.config.js</code>文件 ，然后在<code>package.json</code>中定义打包命令：</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#9ECBFF;">&quot;scripts&quot;</span><span style="color:#E1E4E8;">: {</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">&quot;build&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;webpack&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">},</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#032F62;">&quot;scripts&quot;</span><span style="color:#24292E;">: {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#032F62;">&quot;build&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;webpack&quot;</span></span>
<span class="line"><span style="color:#24292E;">},</span></span></code></pre></div><p>运行<code>npm run build</code>进行打包，命令窗口会出现以下内容：</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">Debugger listening on </span><span style="color:#B392F0;">ws</span><span style="color:#E1E4E8;">:</span><span style="color:#6A737D;">//127.0.0.1:9229/8d04b555-653d-45b0-9d19-00f63aed08b1</span></span>
<span class="line"><span style="color:#E1E4E8;">For help, </span><span style="color:#B392F0;">see</span><span style="color:#E1E4E8;">: </span><span style="color:#B392F0;">https</span><span style="color:#E1E4E8;">:</span><span style="color:#6A737D;">//nodejs.org/en/docs/inspector</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">Debugger listening on </span><span style="color:#6F42C1;">ws</span><span style="color:#24292E;">:</span><span style="color:#6A737D;">//127.0.0.1:9229/8d04b555-653d-45b0-9d19-00f63aed08b1</span></span>
<span class="line"><span style="color:#24292E;">For help, </span><span style="color:#6F42C1;">see</span><span style="color:#24292E;">: </span><span style="color:#6F42C1;">https</span><span style="color:#24292E;">:</span><span style="color:#6A737D;">//nodejs.org/en/docs/inspector</span></span></code></pre></div><h2 id="chrome调试" tabindex="-1">chrome调试 <a class="header-anchor" href="#chrome调试" aria-label="Permalink to &quot;chrome调试&quot;">​</a></h2><p>访问<code>ws://127.0.0.1:9229/8d04b555-653d-45b0-9d19-00f63aed08b1</code>网址并打开<code>chrome</code>控制台:</p><p><img src="`+p+'" alt="img"></p><p>会出现<code>node</code>的<code>logo</code>，点击该<code>logo</code>，即可开始打断点调试：</p><p><img src="'+e+`" alt="img"></p><h2 id="vscode调试" tabindex="-1">vscode调试 <a class="header-anchor" href="#vscode调试" aria-label="Permalink to &quot;vscode调试&quot;">​</a></h2><p>如果想在<code>vscode</code>中调试，手写需要按<code>chrome</code>调试的方法完整操作一遍。然后在<code>vscode</code>中下载<code>chrome</code>调试插件：<code>Debugger for Chrome</code>。下载完成后点击插件提供的运行按钮，选择<code>node</code>环境。在<code>.vscode/</code>目录下会生成一个<code>launch.json</code>文件，将文件替换成一下内容：</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">&quot;version&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;0.2.0&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">&quot;configurations&quot;</span><span style="color:#E1E4E8;">: [</span></span>
<span class="line"><span style="color:#E1E4E8;">      {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">&quot;type&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;pwa-node&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">&quot;request&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;launch&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">&quot;name&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;Debug webpack&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">&quot;skipFiles&quot;</span><span style="color:#E1E4E8;">: [</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#9ECBFF;">&quot;&lt;node_internals&gt;/**&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">        ],</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">&quot;program&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;\${workspaceFolder}/index.js&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">      }</span></span>
<span class="line"><span style="color:#E1E4E8;">    ]</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#032F62;">&quot;version&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;0.2.0&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#032F62;">&quot;configurations&quot;</span><span style="color:#24292E;">: [</span></span>
<span class="line"><span style="color:#24292E;">      {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;type&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;pwa-node&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;request&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;launch&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;name&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;Debug webpack&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;skipFiles&quot;</span><span style="color:#24292E;">: [</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#032F62;">&quot;&lt;node_internals&gt;/**&quot;</span></span>
<span class="line"><span style="color:#24292E;">        ],</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;program&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;\${workspaceFolder}/index.js&quot;</span></span>
<span class="line"><span style="color:#24292E;">      }</span></span>
<span class="line"><span style="color:#24292E;">    ]</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>最终就可以在<code>vscode</code>中调试了： <img src="`+l+'" alt="img"></p><h2 id="小技巧" tabindex="-1">小技巧 <a class="header-anchor" href="#小技巧" aria-label="Permalink to &quot;小技巧&quot;">​</a></h2><div class="tip custom-block"><p class="custom-block-title">调试文档</p><p>debug: <a href="https://webpack.docschina.org/contribute/debugging/" target="_blank" rel="noreferrer">https://webpack.docschina.org/contribute/debugging/</a> setup: <a href="https://github.com/webpack/webpack/blob/main/_SETUP.md" target="_blank" rel="noreferrer">https://github.com/webpack/webpack/blob/main/_SETUP.md</a></p></div><ul><li><code>webpack/examples/</code> 目录下有各种功能的 <code>demo</code>，通过 <code>yarn &amp; yarn link &amp; yarn link webpack</code> 建立软连接，然后再 <code>/examples/xxxx</code> 目录下运行 <code>webpack</code> 即可测试相关功能。</li></ul><h2 id="参考文章" tabindex="-1">参考文章 <a class="header-anchor" href="#参考文章" aria-label="Permalink to &quot;参考文章&quot;">​</a></h2><ul><li><a href="https://segmentfault.com/a/1190000023734819" target="_blank" rel="noreferrer">https://segmentfault.com/a/1190000023734819</a></li></ul>',25),r=[t];function i(E,d,y,u,b,h){return a(),n("div",null,r)}const g=s(c,[["render",i]]);export{k as __pageData,g as default};
