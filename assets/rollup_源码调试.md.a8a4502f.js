import{_ as s,o as a,c as l,Q as o}from"./chunks/framework.b96c6c14.js";const p="/assets/rollup-dist-directory.f353f1a9.png",n="/assets/rollup-debug-url.d1c90576.jpg",e="/assets/rollup-debug-node-logo.80fda00e.jpg",c="/assets/rollup-debug-break.d3909d54.jpg",_=JSON.parse('{"title":"如何调试 rollup 源码？","description":"","frontmatter":{},"headers":[],"relativePath":"rollup/源码调试.md","filePath":"rollup/源码调试.md","lastUpdated":1698927918000}'),t={name:"rollup/源码调试.md"},r=o(`<h1 id="如何调试-rollup-源码" tabindex="-1">如何调试 rollup 源码？ <a class="header-anchor" href="#如何调试-rollup-源码" aria-label="Permalink to &quot;如何调试 rollup 源码？&quot;">​</a></h1><h2 id="_1-拉取代码" tabindex="-1">1. 拉取代码 <a class="header-anchor" href="#_1-拉取代码" aria-label="Permalink to &quot;1. 拉取代码&quot;">​</a></h2><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">git</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">clone</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">https://github.com/rollup/rollup.git</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">git</span><span style="color:#24292E;"> </span><span style="color:#032F62;">clone</span><span style="color:#24292E;"> </span><span style="color:#032F62;">https://github.com/rollup/rollup.git</span></span></code></pre></div><h2 id="_2-安装依赖" tabindex="-1">2. 安装依赖 <a class="header-anchor" href="#_2-安装依赖" aria-label="Permalink to &quot;2. 安装依赖&quot;">​</a></h2><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">yarn</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">yarn</span></span></code></pre></div><p>运行命令后会自动打包生成<code>dist</code>目录。</p><h2 id="_3-添加-inspect-brk" tabindex="-1">3. 添加--inspect-brk <a class="header-anchor" href="#_3-添加-inspect-brk" aria-label="Permalink to &quot;3. 添加--inspect-brk&quot;">​</a></h2><p>在<code>rollup</code>目录中找到<code>dist/bin/rollup</code>文件，在第一行中添加<code>--inspect-brk</code>后缀。</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">// 添加前</span></span>
<span class="line"><span style="color:#E1E4E8;">#</span><span style="color:#F97583;">!/</span><span style="color:#E1E4E8;">usr</span><span style="color:#F97583;">/</span><span style="color:#E1E4E8;">bin</span><span style="color:#F97583;">/</span><span style="color:#E1E4E8;">env node</span></span>
<span class="line"><span style="color:#6A737D;">// 添加后</span></span>
<span class="line"><span style="color:#E1E4E8;">#</span><span style="color:#F97583;">!/</span><span style="color:#E1E4E8;">usr</span><span style="color:#F97583;">/</span><span style="color:#E1E4E8;">bin</span><span style="color:#F97583;">/</span><span style="color:#E1E4E8;">env node </span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">inspect</span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">brk</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">// 添加前</span></span>
<span class="line"><span style="color:#24292E;">#</span><span style="color:#D73A49;">!/</span><span style="color:#24292E;">usr</span><span style="color:#D73A49;">/</span><span style="color:#24292E;">bin</span><span style="color:#D73A49;">/</span><span style="color:#24292E;">env node</span></span>
<span class="line"><span style="color:#6A737D;">// 添加后</span></span>
<span class="line"><span style="color:#24292E;">#</span><span style="color:#D73A49;">!/</span><span style="color:#24292E;">usr</span><span style="color:#D73A49;">/</span><span style="color:#24292E;">bin</span><span style="color:#D73A49;">/</span><span style="color:#24292E;">env node </span><span style="color:#D73A49;">--</span><span style="color:#24292E;">inspect</span><span style="color:#D73A49;">-</span><span style="color:#24292E;">brk</span></span></code></pre></div><p>如下所示：</p><p><img src="`+p+`" alt="dist目录"></p><h2 id="_4-建立rollup软连接" tabindex="-1">4. 建立rollup软连接 <a class="header-anchor" href="#_4-建立rollup软连接" aria-label="Permalink to &quot;4. 建立rollup软连接&quot;">​</a></h2><p>在<code>rollup</code>目录中执行<code>yarn link</code>建立<code>rollup</code>的软连接。</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#79B8FF;">cd</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">rollup</span></span>
<span class="line"><span style="color:#B392F0;">yarn</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">link</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">cd</span><span style="color:#24292E;"> </span><span style="color:#032F62;">rollup</span></span>
<span class="line"><span style="color:#6F42C1;">yarn</span><span style="color:#24292E;"> </span><span style="color:#032F62;">link</span></span></code></pre></div><h2 id="_5-使用rollup" tabindex="-1">5. 使用rollup <a class="header-anchor" href="#_5-使用rollup" aria-label="Permalink to &quot;5. 使用rollup&quot;">​</a></h2><p>新建一个工程目录，比如<code>study-rollup</code>（可以自己随意起名），然后链接<code>rollup</code>：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># 进入 study-rollup 目录</span></span>
<span class="line"><span style="color:#79B8FF;">cd</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">study-rollup</span></span>
<span class="line"><span style="color:#B392F0;">yarn</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">link</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">rollup</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># 进入 study-rollup 目录</span></span>
<span class="line"><span style="color:#005CC5;">cd</span><span style="color:#24292E;"> </span><span style="color:#032F62;">study-rollup</span></span>
<span class="line"><span style="color:#6F42C1;">yarn</span><span style="color:#24292E;"> </span><span style="color:#032F62;">link</span><span style="color:#24292E;"> </span><span style="color:#032F62;">rollup</span></span></code></pre></div><h2 id="_6-运行" tabindex="-1">6. 运行 <a class="header-anchor" href="#_6-运行" aria-label="Permalink to &quot;6. 运行&quot;">​</a></h2><p>在终端中运行<code>rollup</code>命令（也可以在<code>package.json</code>的<code>scripts</code>中定义命令）。</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># 进入 study-rollup 目录</span></span>
<span class="line"><span style="color:#79B8FF;">cd</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">study-rollup</span></span>
<span class="line"><span style="color:#B392F0;">rollup</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-c</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># 进入 study-rollup 目录</span></span>
<span class="line"><span style="color:#005CC5;">cd</span><span style="color:#24292E;"> </span><span style="color:#032F62;">study-rollup</span></span>
<span class="line"><span style="color:#6F42C1;">rollup</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-c</span></span></code></pre></div><p>运行后会出现一个<code>ws:</code>开头的<code>url</code>：</p><p><img src="`+n+`" alt="调试地址"></p><h2 id="_7-浏览器调试" tabindex="-1">7. 浏览器调试 <a class="header-anchor" href="#_7-浏览器调试" aria-label="Permalink to &quot;7. 浏览器调试&quot;">​</a></h2><p>在浏览器中打开上一个步骤中的<code>url</code>，如：</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">// 注意：每次运行时的地址不一样</span></span>
<span class="line"><span style="color:#B392F0;">ws</span><span style="color:#E1E4E8;">:</span><span style="color:#6A737D;">//127.0.0.1:9229/012b3b38-94de-4d45-b899-f629917c52c7</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">// 注意：每次运行时的地址不一样</span></span>
<span class="line"><span style="color:#6F42C1;">ws</span><span style="color:#24292E;">:</span><span style="color:#6A737D;">//127.0.0.1:9229/012b3b38-94de-4d45-b899-f629917c52c7</span></span></code></pre></div><p>打开<code>Chrome</code>控制台，会发现一个<code>node</code>的<code>logo</code>：</p><p><img src="`+e+'" alt="node logo"></p><p>点击该<code>logo</code>，会弹出一个窗口，找到<code>Sources</code>选项，通过<code>Add folder to workspace</code>将我们前面下载好的<code>rollup</code>包导入进来，然后找到<code>rollup</code>的源码入口，打上断点，就可以调试了。</p><p><img src="'+c+'" alt="Chrome 调试"></p>',29),d=[r];function i(y,u,h,E,b,g){return a(),l("div",null,d)}const v=s(t,[["render",i]]);export{_ as __pageData,v as default};
