import{_ as n,c as s,o as a,a as t}from"./app.f27e6278.js";const h='{"title":"Drawer \u5D4C\u5957\u504F\u79FB","description":"","frontmatter":{},"headers":[],"relativePath":"project/drawer.md","lastUpdated":1658882521000}',p={},o=t(`<h1 id="drawer-\u5D4C\u5957\u504F\u79FB" tabindex="-1">Drawer \u5D4C\u5957\u504F\u79FB <a class="header-anchor" href="#drawer-\u5D4C\u5957\u504F\u79FB" aria-hidden="true">#</a></h1><ol><li>\u901A\u8FC7 <code>Context</code> \u5C06\u7236 <code>Drawer</code> \u7684\u504F\u79FB\u4F20\u9012\u7ED9\u5B50 <code>Drawer</code>\u3002</li></ol><div class="language-typescript"><pre><code><span class="token keyword">type</span> <span class="token class-name">ParrentDrawer</span> <span class="token operator">=</span> Drawer <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> DrawerContext <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">createContext</span><span class="token generic class-name"><span class="token operator">&lt;</span>ParrentDrawer<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// class component</span>
<span class="token function-variable function">renderProvider</span> <span class="token operator">=</span> <span class="token punctuation">(</span>value<span class="token operator">:</span> Drawer<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> visible <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>parentDrawer <span class="token operator">=</span> value<span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>DrawerContext<span class="token punctuation">.</span>Provider value<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>RcDrawer open<span class="token operator">=</span><span class="token punctuation">{</span>visible<span class="token punctuation">}</span><span class="token operator">&gt;</span>
        <span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">renderBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>RcDrawer<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>DrawerContext<span class="token punctuation">.</span>Provider<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token operator">&lt;</span>DrawerContext<span class="token punctuation">.</span>Consumer<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>renderProvider<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>DrawerContext<span class="token punctuation">.</span>Consumer<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="2"><li>\u5B50 <code>Drawer</code> \u5728\u663E\u793A\u65F6\uFF0C\u89E6\u53D1\u7236 <code>Drawer</code> \u504F\u79FB\uFF0C\u5982<code>pushDistance</code>\u3002</li></ol><div class="language-typescript"><pre><code><span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>parentDrawer <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>visible<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>parentDrawer<span class="token punctuation">.</span><span class="token function">updateWidth</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>displayWidth<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token function">componentDidUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// \u53EA\u6709 visible \u4E0A\u4E00\u4E2A\u72B6\u6001\u662F false, \u5F53\u524D\u72B6\u6001\u4E5F\u662F false\uFF0C\u90A3\u4E48\u4E0D\u9700\u8981\u66F4\u65B0\u3002</span>
  <span class="token comment">// \u5904\u7406\u7236 Drawer \u4E0B\u6709\u591A\u4E2A\u5B50 Drawer \u7684\u60C5\u51B5\uFF0C\u53EA\u6709\u5728\u5B50 Drawer \u53D1\u751F\u6539\u53D8\u65F6\u624D\u4F1A\u9012\u5F52\u5411\u4E0A\u66F4\u65B0\u3002</span>
  <span class="token keyword">const</span> shouldUpdate <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>visible <span class="token operator">||</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>prevVisible<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>parentDrawer <span class="token operator">&amp;&amp;</span> shouldUpdate<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>parentDrawer<span class="token punctuation">.</span><span class="token function">updateWidth</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>visible<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>displayWidth<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token function">componentWillUnmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>parentDrawer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>parentDrawer<span class="token punctuation">.</span><span class="token function">updateWidth</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>displayWidth<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="3"><li>\u7236 <code>Drawer</code> \u5F00\u59CB\u504F\u79FB</li></ol><div class="language-typescript"><pre><code><span class="token function-variable function">updateWidth</span> <span class="token operator">=</span> <span class="token punctuation">(</span>isPush<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">,</span> childDisplayWidth<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> pushDistance <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">;</span>
  <span class="token comment">// \u5F53\u524D\u62BD\u5C49\u5E94\u8BE5\u663E\u793A\u7684\u5BBD\u5EA6</span>
  <span class="token keyword">const</span> realWidth <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">resolveDrawerWidth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> shouldDisplayWidth <span class="token operator">=</span> realWidth<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>isPush<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// \u5982\u679C\u662F\u63A8\u5F00\u72B6\u6001\u9700\u8981\u8BA1\u7B97\u5BBD\u5EA6</span>
    shouldDisplayWidth <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>realWidth<span class="token punctuation">,</span> childDisplayWidth <span class="token operator">+</span> pushDistance<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> isPush<span class="token punctuation">,</span> displayWidth<span class="token operator">:</span> shouldDisplayWidth <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// \u66F4\u65B0 transform</span>
<span class="token function-variable function">getDrawerStyle</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> width <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">resolveDrawerWidth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> isPush<span class="token punctuation">,</span> displayWidth <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">;</span>
  <span class="token keyword">return</span> isPush <span class="token operator">?</span> <span class="token punctuation">{</span> transform<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">translateX(-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>displayWidth <span class="token operator">-</span> width<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px)</span><span class="token template-punctuation string">\`</span></span> <span class="token punctuation">}</span> <span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div>`,7),e=[o];function c(l,u,k,i,r,d){return a(),s("div",null,e)}var y=n(p,[["render",c]]);export{h as __pageData,y as default};
